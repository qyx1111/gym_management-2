# NUAAå¥èº«æˆ¿ç®¡ç†ç³»ç»Ÿæ•°æ®åº“è¯¾è®¾å®éªŒæŠ¥å‘Š

**é¡¹ç›®ï¼š NUAAå¥èº«æˆ¿ç®¡ç†ç³»ç»Ÿ**
**å­¦å·ï¼š 162220312**
**å§“åï¼š é‚±è£•è½©**
**ç­çº§ï¼š 1622203**
**æŒ‡å¯¼è€å¸ˆï¼šå‘¨è‰¯**

## ç›®å½•

[TOC]

## ä¸€ã€å®éªŒç¯å¢ƒ

**å‰ç«¯ï¼š HTML5 + CSS3 + JavaScript ** 
**åç«¯ï¼š Python Flaskæ¡†æ¶** 
**æ•°æ®åº“ï¼š SQLite**
**å¼€å‘å·¥å…·ï¼š Visual Studio Code** 
**æ“ä½œç³»ç»Ÿï¼š Windows** 
**APIæ¶æ„ï¼š RESTful API**

## äºŒã€é¡¹ç›®ç»„ç»‡

```
Database/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app.py                    # Flaskä¸»åº”ç”¨æ–‡ä»¶
â”‚   â”œâ”€â”€ production_config.py      # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ requirements.txt          # é¡¹ç›®ä¾èµ–åŒ…
â”œâ”€â”€ db/
â”‚   â”œâ”€â”€ database_operations.py    # æ•°æ®åº“æ“ä½œå°è£…
â”‚   â”œâ”€â”€ database_setup.py         # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”‚   â””â”€â”€ gym_management.db         # SQLiteæ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ index.html                # ç³»ç»Ÿä¸»é¡µé¢
â”‚   â”œâ”€â”€ scripts/
â”‚   â”‚   â”œâ”€â”€ api.js                # APIå®¢æˆ·ç«¯å°è£…
â”‚   â”‚   â”œâ”€â”€ main.js               # ä¸»è¦åŠŸèƒ½å’Œå¯¼èˆª
â”‚   â”‚   â”œâ”€â”€ members.js            # ä¼šå‘˜ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ memberDetail.js       # ä¼šå‘˜è¯¦æƒ…ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ trainers.js           # æ•™ç»ƒç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ trainerDetail.js      # æ•™ç»ƒè¯¦æƒ…ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ courses.js            # è¯¾ç¨‹ç®¡ç†æ¨¡å—
â”‚   â”‚   â””â”€â”€ cardTypes.js          # ä¼šå‘˜å¡ç±»å‹ç®¡ç†
â”‚   â””â”€â”€ styles/
â”‚       â””â”€â”€ main.css              # ç³»ç»Ÿæ ·å¼æ–‡ä»¶
```

## ä¸‰ã€å®éªŒç›®çš„

è®¾è®¡å¹¶å®ç°ä¸€ä¸ªå®Œæ•´çš„å¥èº«æˆ¿ç®¡ç†ç³»ç»Ÿï¼Œæ¶µç›–å¥èº«æˆ¿è¿è¥çš„æ ¸å¿ƒä¸šåŠ¡æµç¨‹ã€‚é€šè¿‡æœ¬é¡¹ç›®æŒæ¡ï¼š

1. **æ•°æ®åº“è®¾è®¡èƒ½åŠ›**ï¼šå®Œæ•´çš„E-Rå»ºæ¨¡ã€å…³ç³»æ¨¡å¼è®¾è®¡ã€æ•°æ®å­—å…¸ç¼–å†™
2. **SQLåº”ç”¨èƒ½åŠ›**ï¼šå¤æ‚æŸ¥è¯¢ã€å¤šè¡¨è¿æ¥ã€èšåˆå‡½æ•°ã€äº‹åŠ¡å¤„ç†
3. **ç³»ç»Ÿæ¶æ„è®¾è®¡**ï¼šå‰åç«¯åˆ†ç¦»ã€RESTful APIè®¾è®¡ã€æ¨¡å—åŒ–å¼€å‘
4. **ä¸šåŠ¡é€»è¾‘å®ç°**ï¼šå¥èº«æˆ¿å®Œæ•´ä¸šåŠ¡æµç¨‹çš„æ•°å­—åŒ–å®ç°
5. **ç”¨æˆ·ç•Œé¢è®¾è®¡**ï¼šå“åº”å¼è®¾è®¡ã€äº¤äº’ä½“éªŒä¼˜åŒ–

## å››ã€æ•°æ®åº“è®¾è®¡

### éœ€æ±‚åˆ†æ

NUAAå¥èº«æˆ¿ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„ä¸šåŠ¡ç®¡ç†å¹³å°ï¼Œéœ€è¦æ”¯æŒä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

#### æ ¸å¿ƒä¸šåŠ¡æ¨¡å—

ğŸ“‹ **ä¼šå‘˜ç®¡ç†ç³»ç»Ÿ**
- ä¼šå‘˜åŸºæœ¬ä¿¡æ¯ç®¡ç†ï¼ˆå§“åã€è”ç³»æ–¹å¼ã€ä¸ªäººä¿¡æ¯ï¼‰
- ä¼šå‘˜çŠ¶æ€è·Ÿè¸ªï¼ˆæ´»è·ƒã€æ³¨é”€ï¼‰
- ä¼šå‘˜æœç´¢å’Œè¯¦æƒ…æŸ¥çœ‹

ğŸ“‹ **æ•™ç»ƒç®¡ç†ç³»ç»Ÿ**
- æ•™ç»ƒåŸºæœ¬ä¿¡æ¯ç®¡ç†
- æ•™ç»ƒä¸“ä¸šæŠ€èƒ½å’Œè®¤è¯ç®¡ç†
- æ•™ç»ƒå·¥ä½œçŠ¶æ€ç®¡ç†ï¼ˆæ´»è·ƒã€ç¦»èŒï¼‰

ğŸ“‹ **è¯¾ç¨‹ç®¡ç†ç³»ç»Ÿ**
- è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯é…ç½®ï¼ˆåç§°ã€æè¿°ã€æ—¶é•¿ã€ä»·æ ¼ï¼‰
- è¯¾ç¨‹çŠ¶æ€ç®¡ç†ï¼ˆæ´»è·ƒã€åœç”¨ï¼‰
- è¯¾ç¨‹æœç´¢å’Œç­›é€‰

ğŸ“‹ **ä¼šå‘˜å¡ç±»å‹ç®¡ç†**
- å¡ç±»å‹é…ç½®ï¼ˆä»·æ ¼ã€æœ‰æ•ˆæœŸã€æƒç›Šæè¿°ï¼‰
- å¡ç±»å‹çš„å¯ç”¨/åœç”¨ç®¡ç†

#### å…³è”ä¸šåŠ¡æ¨¡å—

ğŸ’³ **ä¼šå‘˜å¡ç®¡ç†**
- ä¼šå‘˜æŒå¡è®°å½•ç®¡ç†
- å¡ç‰‡è´­ä¹°æ—¥æœŸå’Œåˆ°æœŸæ—¥æœŸè·Ÿè¸ª
- å¡ç‰‡çŠ¶æ€ç®¡ç†ï¼ˆæœ‰æ•ˆã€è¿‡æœŸã€æš‚åœï¼‰

ğŸ“š **è¯¾ç¨‹æŠ¥åç®¡ç†**
- ä¼šå‘˜è¯¾ç¨‹æŠ¥åè®°å½•
- æŠ¥åçŠ¶æ€è·Ÿè¸ªï¼ˆå·²æŠ¥åã€è¿›è¡Œä¸­ã€å·²å®Œæˆã€å·²å–æ¶ˆï¼‰
- æŠ¥åæ—¶é—´ç®¡ç†

ğŸ‘¥ **æ•™ç»ƒæŒ‡æ´¾ç®¡ç†**
- æ•™ç»ƒä¸ä¼šå‘˜çš„æŒ‡æ´¾å…³ç³»
- æŒ‡æ´¾ç±»å‹ç®¡ç†ï¼ˆç§æ•™ã€å›¢ä½“è¯¾ã€å’¨è¯¢ã€ä½“èƒ½è¯„ä¼°ï¼‰
- æŒ‡æ´¾æ—¶é—´å’ŒçŠ¶æ€è·Ÿè¸ª

ğŸ¯ **æ•™ç»ƒè¯¾ç¨‹åˆ†é…**
- æ•™ç»ƒæ•™æˆè¯¾ç¨‹çš„åˆ†é…å…³ç³»
- æ•™ç»ƒè¯¾ç¨‹è´Ÿè´£çŠ¶æ€ç®¡ç†

### E-Rå›¾è®¾è®¡

![image-20250609211733884](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250609211733884.png)

### ç³»ç»Ÿè®¾è®¡

#### é€»è¾‘è®¾è®¡â€”â€”å…³ç³»æ¨¡å¼

**å°†E-Rå›¾è½¬æ¢ä¸ºå…³ç³»æ¨¡å¼å¦‚ä¸‹ï¼ˆä¸‹åˆ’çº¿ä¸ºä¸»é”®ï¼‰ï¼š**

1. **ä¼šå‘˜è¡¨ Members(<u>ä¼šå‘˜ç¼–å·</u>, å§“å, è”ç³»ç”µè¯, ç”µå­é‚®ç®±, æ€§åˆ«, å‡ºç”Ÿæ—¥æœŸ, å…¥ä¼šæ—¥æœŸ, ä¼šå‘˜çŠ¶æ€)**
2. **æ•™ç»ƒè¡¨ Trainers(<u>æ•™ç»ƒç¼–å·</u>, å§“å, è”ç³»ç”µè¯, ç”µå­é‚®ç®±, ä¸“ä¸šé¢†åŸŸ, å…¥èŒæ—¥æœŸ, æ•™ç»ƒçŠ¶æ€)**
3. **è¯¾ç¨‹è¡¨ Courses(<u>è¯¾ç¨‹ç¼–å·</u>, è¯¾ç¨‹åç§°, è¯¾ç¨‹æè¿°, è¯¾ç¨‹æ—¶é•¿, è¯¾ç¨‹ä»·æ ¼, è¯¾ç¨‹çŠ¶æ€)**
4. **ä¼šå‘˜å¡ç±»å‹è¡¨ CardTypes(<u>å¡ç±»å‹ç¼–å·</u>, å¡ç±»å‹åç§°, å¡ç±»å‹ä»·æ ¼, æœ‰æ•ˆæœŸå¤©æ•°, æƒç›Šæè¿°)**
5. **ä¼šå‘˜å¡è¡¨ MemberCards(<u>ä¼šå‘˜å¡ç¼–å·</u>, ä¼šå‘˜ç¼–å·, å¡ç±»å‹ç¼–å·, è´­ä¹°æ—¥æœŸ, åˆ°æœŸæ—¥æœŸ, å¡ç‰‡çŠ¶æ€)**
6. **è¯¾ç¨‹æŠ¥åè¡¨ CourseEnrollments(<u>æŠ¥åç¼–å·</u>, ä¼šå‘˜ç¼–å·, è¯¾ç¨‹ç¼–å·, æŠ¥åæ—¥æœŸ, æŠ¥åçŠ¶æ€)**
7. **æ•™ç»ƒæŒ‡æ´¾è¡¨ TrainerAssignments(<u>æŒ‡æ´¾ç¼–å·</u>, æ•™ç»ƒç¼–å·, ä¼šå‘˜ç¼–å·, æŒ‡æ´¾æ—¥æœŸ, æŒ‡æ´¾ç±»å‹, æŒ‡æ´¾çŠ¶æ€)**
8. **æ•™ç»ƒè¯¾ç¨‹è¡¨ TrainerCourses(<u>åˆ†é…ç¼–å·</u>, æ•™ç»ƒç¼–å·, è¯¾ç¨‹ç¼–å·, åˆ†é…æ—¥æœŸ, åˆ†é…çŠ¶æ€)**

#### ç‰©ç†è®¾è®¡â€”â€”æ•°æ®å­—å…¸

**ä¼šå‘˜è¡¨ (members)**

| å­—æ®µå | å«ä¹‰ | æ•°æ®ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|--------|------|----------|------|------|
| id | ä¼šå‘˜å”¯ä¸€æ ‡è¯† | INTEGER | PRIMARY KEY AUTOINCREMENT | è‡ªåŠ¨é€’å¢ä¸»é”® |
| name | ä¼šå‘˜å§“å | TEXT | NOT NULL | ä¼šå‘˜çœŸå®å§“å |
| phone | æ‰‹æœºå·ç  | TEXT | | è”ç³»ç”µè¯ |
| email | ç”µå­é‚®ç®± | TEXT | | ç”µå­é‚®ä»¶åœ°å€ |
| gender | æ€§åˆ« | TEXT | | ç”·/å¥³/å…¶ä»– |
| birth_date | å‡ºç”Ÿæ—¥æœŸ | TEXT | | YYYY-MM-DDæ ¼å¼ |
| join_date | æ³¨å†Œæ—¥æœŸ | TEXT | | ä¼šå‘˜æ³¨å†Œæ—¶é—´ |
| status | ä¼šå‘˜çŠ¶æ€ | TEXT | DEFAULT 'active' | active/inactive|

**æ•™ç»ƒè¡¨ (trainers)**

| å­—æ®µå | å«ä¹‰ | æ•°æ®ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|--------|------|----------|------|------|
| id | æ•™ç»ƒå”¯ä¸€æ ‡è¯† | INTEGER | PRIMARY KEY AUTOINCREMENT | è‡ªåŠ¨é€’å¢ä¸»é”® |
| name | æ•™ç»ƒå§“å | TEXT | NOT NULL | æ•™ç»ƒçœŸå®å§“å |
| phone | æ‰‹æœºå·ç  | TEXT | | è”ç³»ç”µè¯ |
| email | ç”µå­é‚®ç®± | TEXT | | ç”µå­é‚®ä»¶åœ°å€ |
| specialization | ä¸“ä¸šé¢†åŸŸ | TEXT | | å¦‚ï¼šç‘œä¼½ã€åŠ›é‡è®­ç»ƒç­‰ |
| hire_date | å…¥èŒæ—¥æœŸ | TEXT | | æ•™ç»ƒå…¥èŒæ—¶é—´ |
| status | æ•™ç»ƒçŠ¶æ€ | TEXT | DEFAULT 'active' | active/inactive |

**è¯¾ç¨‹è¡¨ (courses)**

| å­—æ®µå | å«ä¹‰ | æ•°æ®ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|--------|------|----------|------|------|
| id | è¯¾ç¨‹å”¯ä¸€æ ‡è¯† | INTEGER | PRIMARY KEY AUTOINCREMENT | è‡ªåŠ¨é€’å¢ä¸»é”® |
| name | è¯¾ç¨‹åç§° | TEXT | NOT NULL | è¯¾ç¨‹æ ‡é¢˜ |
| description | è¯¾ç¨‹æè¿° | TEXT | | è¯¦ç»†ä»‹ç» |
| duration | è¯¾ç¨‹æ—¶é•¿ | INTEGER | | ä»¥åˆ†é’Ÿä¸ºå•ä½ |
| price | è¯¾ç¨‹ä»·æ ¼ | REAL | | å•æ¬¡è¯¾ç¨‹è´¹ç”¨ |
| status | è¯¾ç¨‹çŠ¶æ€ | TEXT | DEFAULT 'active' | active/inactive |

**ä¼šå‘˜å¡ç±»å‹è¡¨ (card_types)**

| å­—æ®µå | å«ä¹‰ | æ•°æ®ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|--------|------|----------|------|------|
| id | å¡ç±»å‹å”¯ä¸€æ ‡è¯† | INTEGER | PRIMARY KEY AUTOINCREMENT | è‡ªåŠ¨é€’å¢ä¸»é”® |
| name | å¡ç±»å‹åç§° | TEXT | NOT NULL | å¦‚ï¼šæœˆå¡ã€å­£å¡ã€å¹´å¡ |
| price | å¡ç±»å‹ä»·æ ¼ | REAL | NOT NULL | åŠå¡è´¹ç”¨ |
| validity_days | æœ‰æ•ˆæœŸå¤©æ•° | INTEGER | NOT NULL | å¡ç‰‡æœ‰æ•ˆå¤©æ•° |
| description | å¡ç±»å‹æè¿° | TEXT | | æƒç›Šè¯´æ˜ |

**ä¼šå‘˜å¡è¡¨ (member_cards)**

| å­—æ®µå | å«ä¹‰ | æ•°æ®ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|--------|------|----------|------|------|
| id | ä¼šå‘˜å¡å”¯ä¸€æ ‡è¯† | INTEGER | PRIMARY KEY AUTOINCREMENT | è‡ªåŠ¨é€’å¢ä¸»é”® |
| member_id | ä¼šå‘˜ID | INTEGER | NOT NULL, FOREIGN KEY | å…³è”ä¼šå‘˜è¡¨ |
| card_type_id | å¡ç±»å‹ID | INTEGER | NOT NULL, FOREIGN KEY | å…³è”å¡ç±»å‹è¡¨ |
| purchase_date | è´­ä¹°æ—¥æœŸ | TEXT | NOT NULL | åŠå¡æ—¥æœŸ |
| expiry_date | åˆ°æœŸæ—¥æœŸ | TEXT | NOT NULL | å¡ç‰‡åˆ°æœŸæ—¶é—´ |
| status | å¡ç‰‡çŠ¶æ€ | TEXT | DEFAULT 'active' | active/inactive |

**è¯¾ç¨‹æŠ¥åè¡¨ (course_enrollments)**

| å­—æ®µå | å«ä¹‰ | æ•°æ®ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|--------|------|----------|------|------|
| id | æŠ¥åè®°å½•å”¯ä¸€æ ‡è¯† | INTEGER | PRIMARY KEY AUTOINCREMENT | è‡ªåŠ¨é€’å¢ä¸»é”® |
| member_id | ä¼šå‘˜ID | INTEGER | NOT NULL, FOREIGN KEY | å…³è”ä¼šå‘˜è¡¨ |
| course_id | è¯¾ç¨‹ID | INTEGER | NOT NULL, FOREIGN KEY | å…³è”è¯¾ç¨‹è¡¨ |
| enrollment_date | æŠ¥åæ—¥æœŸ | TEXT | NOT NULL | æŠ¥åæ—¶é—´ |
| status | æŠ¥åçŠ¶æ€ | TEXT | DEFAULT 'active' | enrolled/in_progress/completed/cancelled |

**æ•™ç»ƒæŒ‡æ´¾è¡¨ (trainer_assignments)**

| å­—æ®µå | å«ä¹‰ | æ•°æ®ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|:-------|------|----------|------|------|
| id | æŒ‡æ´¾è®°å½•å”¯ä¸€æ ‡è¯† | INTEGER | PRIMARY KEY AUTOINCREMENT | è‡ªåŠ¨é€’å¢ä¸»é”® |
| trainer_id | æ•™ç»ƒID | INTEGER | NOT NULL, FOREIGN KEY | å…³è”æ•™ç»ƒè¡¨ |
| member_id | ä¼šå‘˜ID | INTEGER | NOT NULL, FOREIGN KEY | å…³è”ä¼šå‘˜è¡¨ |
| assignment_date | æŒ‡æ´¾æ—¥æœŸ | TEXT | NOT NULL | æŒ‡æ´¾æ—¶é—´ |
| assignment_type | æŒ‡æ´¾ç±»å‹ | TEXT | NOT NULL | ç§æ•™/å›¢ä½“è¯¾/å’¨è¯¢/ä½“èƒ½è¯„ä¼° |
| status | æŒ‡æ´¾çŠ¶æ€ | TEXT | DEFAULT 'active' | active/inactive |

**æ•™ç»ƒè¯¾ç¨‹åˆ†é…è¡¨ (trainer_course_assignments)**

| å­—æ®µå          | å«ä¹‰             | æ•°æ®ç±»å‹ | çº¦æŸ                      | è¯´æ˜                                 |
| --------------- | ---------------- | -------- | ------------------------- | ------------------------------------ |
| id              | åˆ†é…è®°å½•å”¯ä¸€æ ‡è¯† | INTEGER  | PRIMARY KEY AUTOINCREMENT | è‡ªåŠ¨é€’å¢ä¸»é”®                         |
| trainer_id      | æ•™ç»ƒID           | INTEGER  | NOT NULL, FOREIGN KEY     | å…³è”trainersè¡¨çš„id                   |
| course_id       | è¯¾ç¨‹ID           | INTEGER  | NOT NULL, FOREIGN KEY     | å…³è”coursesè¡¨çš„id                    |
| assignment_date | åˆ†é…æ—¥æœŸ         | TEXT     | NOT NULL                  | YYYY-MM-DDæ ¼å¼ï¼Œè¯¾ç¨‹åˆ†é…ç»™æ•™ç»ƒçš„æ—¥æœŸ |
| course_type     | è¯¾ç¨‹ç±»å‹         | TEXT     |                           | å¦‚ï¼šå¸¸è§„è¯¾ç¨‹/ç§æ•™è¯¾ç¨‹/å›¢ä½“è¯¾ç­‰       |
| notes           | å¤‡æ³¨ä¿¡æ¯         | TEXT     |                           | åˆ†é…ç›¸å…³çš„é¢å¤–è¯´æ˜                   |

## äº”ã€åŠŸèƒ½å®ç°ä¸æ¼”ç¤º

### 5.1 DDLï¼šæ•°æ®åº“çš„å»ºç«‹

#### æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

````python
# filepath: database_setup.py
def create_tables():
    """åˆ›å»ºæ•°æ®åº“è¡¨"""
    conn = create_connection()
    if conn is not None:
        try:
            cursor = conn.cursor()
            # ä¼šå‘˜è¡¨
            cursor.execute("""
                CREATE TABLE IF NOT EXISTS members (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    name TEXT NOT NULL,
                    gender TEXT,
                    birth_date TEXT,
                    phone TEXT UNIQUE,
                    emergency_contact_name TEXT,
                    emergency_contact_phone TEXT,
                    health_notes TEXT,
                    join_date TEXT NOT NULL,
                    status TEXT DEFAULT 'active' 
                );
            """)
            # ä¼šå‘˜å¡ç±»å‹è¡¨
            cursor.execute("""
                CREATE TABLE IF NOT EXISTS membership_card_types (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    name TEXT NOT NULL UNIQUE,
                    price REAL NOT NULL,
                    duration_days INTEGER NOT NULL,
                    description TEXT
                );
            """)
            # ä¼šå‘˜å¡å®ä¾‹è¡¨ (ä¼šå‘˜æ‹¥æœ‰çš„å¡) - è¿™æ˜¯"ä¼šå‘˜ä¸ä¼šå‘˜å¡çš„å…³ç³»è¡¨"
            cursor.execute("""
                CREATE TABLE IF NOT EXISTS member_cards (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    member_id INTEGER NOT NULL,
                    card_type_id INTEGER NOT NULL,
                    purchase_date TEXT NOT NULL,
                    activation_date TEXT, 
                    expiry_date TEXT NOT NULL,
                    status TEXT DEFAULT 'pending_activation', -- e.g., pending_activation, active, frozen, expired, cancelled
                    notes TEXT,
                    FOREIGN KEY (member_id) REFERENCES members (id) ON DELETE CASCADE ON UPDATE CASCADE,
                    FOREIGN KEY (card_type_id) REFERENCES membership_card_types (id) ON DELETE CASCADE ON UPDATE CASCADE
                );
            """)
            # è¯¾ç¨‹è¡¨
            cursor.execute("""
                CREATE TABLE IF NOT EXISTS courses (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    name TEXT NOT NULL UNIQUE,
                    description TEXT,
                    default_duration_minutes INTEGER,
                    status TEXT DEFAULT 'active' 
                );
            """)
            # æ•™ç»ƒè¡¨
            cursor.execute("""
                CREATE TABLE IF NOT EXISTS trainers (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    name TEXT NOT NULL,
                    specialty TEXT,
                    contact_info TEXT,
                    status TEXT DEFAULT 'active' 
                );
            """)

            # æ–°å¢ï¼šä¼šå‘˜ä¸è¯¾ç¨‹çš„æŠ¥å/å…³ç³»è¡¨
            cursor.execute("""
                CREATE TABLE IF NOT EXISTS member_course_enrollments (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    member_id INTEGER NOT NULL,
                    course_id INTEGER NOT NULL,
                    enrollment_date TEXT NOT NULL,
                    status TEXT DEFAULT 'enrolled', -- e.g., enrolled, completed, dropped
                    notes TEXT,
                    FOREIGN KEY (member_id) REFERENCES members (id) ON DELETE CASCADE ON UPDATE CASCADE,
                    FOREIGN KEY (course_id) REFERENCES courses (id) ON DELETE CASCADE ON UPDATE CASCADE
                );
            """)

            # æ–°å¢ï¼šä¼šå‘˜ä¸æ•™ç»ƒçš„åˆ†é…/å…³ç³»è¡¨
            cursor.execute("""
                CREATE TABLE IF NOT EXISTS member_trainer_assignments (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    member_id INTEGER NOT NULL,
                    trainer_id INTEGER NOT NULL,
                    assignment_date TEXT NOT NULL,
                    assignment_type TEXT, -- e.g., personal_training_package, consultation
                    notes TEXT,
                    FOREIGN KEY (member_id) REFERENCES members (id) ON DELETE CASCADE ON UPDATE CASCADE,
                    FOREIGN KEY (trainer_id) REFERENCES trainers (id) ON DELETE CASCADE ON UPDATE CASCADE
                );
            """)

            # æ–°å¢ï¼šæ•™ç»ƒä¸è¯¾ç¨‹çš„åˆ†é…/å…³ç³»è¡¨
            cursor.execute("""
                CREATE TABLE IF NOT EXISTS trainer_course_assignments (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    trainer_id INTEGER NOT NULL,
                    course_id INTEGER NOT NULL,
                    assignment_date TEXT NOT NULL,
                    course_type TEXT, -- e.g., regular, special, private, group
                    notes TEXT,
                    FOREIGN KEY (trainer_id) REFERENCES trainers (id) ON DELETE CASCADE ON UPDATE CASCADE,
                    FOREIGN KEY (course_id) REFERENCES courses (id) ON DELETE CASCADE ON UPDATE CASCADE
                );
            """)
            
            conn.commit()
            print("æ•°æ®åº“è¡¨åˆ›å»ºæˆåŠŸæˆ–å·²å­˜åœ¨ã€‚")
        except sqlite3.Error as e:
            print(f"åˆ›å»ºè¡¨æ—¶å‡ºé”™: {e}")
        finally:
            conn.close()
    else:
        print("é”™è¯¯ï¼æ— æ³•åˆ›å»ºæ•°æ®åº“è¿æ¥ã€‚")
````

#### æ•°æ®åº“æ“ä½œå°è£…

````python
# filepath: db/database_operations.py
import sqlite3
import os
from datetime import datetime, timedelta

class DatabaseOperations:
    def __init__(self):
        self.db_path = os.path.join(os.path.dirname(__file__), 'gym_management.db')
    
    def get_connection(self):
        """è·å–æ•°æ®åº“è¿æ¥"""
        conn = sqlite3.connect(self.db_path)
        conn.row_factory = sqlite3.Row  # è¿”å›å­—å…¸æ ¼å¼çš„ç»“æœ
        return conn
    
    def execute_query(self, query, params=None):
        """æ‰§è¡ŒæŸ¥è¯¢è¯­å¥"""
        conn = self.get_connection()
        cursor = conn.cursor()
        try:
            if params:
                cursor.execute(query, params)
            else:
                cursor.execute(query)
            return cursor.fetchall()
        finally:
            conn.close()
    
    def execute_update(self, query, params=None):
        """æ‰§è¡Œæ›´æ–°è¯­å¥"""
        conn = self.get_connection()
        cursor = conn.cursor()
        try:
            if params:
                cursor.execute(query, params)
            else:
                cursor.execute(query)
            conn.commit()
            return cursor.lastrowid
        finally:
            conn.close()
````

### 5.2 DMLï¼šæ•°æ®åº“çš„æ•°æ®æ“ä½œ

#### 1. ä¼šå‘˜ç®¡ç†åŠŸèƒ½å®ç°

**ä¼šå‘˜ä¿¡æ¯çš„å®Œæ•´CRUDæ“ä½œ**

````python
# filepath: backend/app.py
from flask import Flask, request, jsonify
import sqlite3
import os
from datetime import datetime

app = Flask(__name__)

def get_db_connection():
    """è·å–æ•°æ®åº“è¿æ¥"""
    db_path = os.path.join('db', 'gym_management.db')
    conn = sqlite3.connect(db_path)
    conn.row_factory = sqlite3.Row
    return conn

# è·å–æ‰€æœ‰ä¼šå‘˜ï¼ˆæ”¯æŒæœç´¢ï¼‰
@app.route('/api/members', methods=['GET'])
def get_members():
    search = request.args.get('search', '')
    conn = get_db_connection()
    
    if search:
        query = '''
            SELECT * FROM members 
            WHERE name LIKE ? OR phone LIKE ? OR email LIKE ?
            ORDER BY join_date DESC
        '''
        members = conn.execute(query, (f'%{search}%', f'%{search}%', f'%{search}%')).fetchall()
    else:
        members = conn.execute('SELECT * FROM members ORDER BY join_date DESC').fetchall()
    
    conn.close()
    return jsonify([dict(member) for member in members])

# åˆ›å»ºæ–°ä¼šå‘˜
@app.route('/api/members', methods=['POST'])
def create_member():
    data = request.json
    conn = get_db_connection()
    
    query = '''
        INSERT INTO members (name, phone, email, gender, birth_date, join_date, status)
        VALUES (?, ?, ?, ?, ?, ?, ?)
    '''
    
    cursor = conn.execute(query, (
        data['name'],
        data.get('phone', ''),
        data.get('email', ''),
        data.get('gender', ''),
        data.get('birth_date', ''),
        data.get('join_date', datetime.now().strftime('%Y-%m-%d')),
        data.get('status', 'active')
    ))
    
    conn.commit()
    member_id = cursor.lastrowid
    conn.close()
    
    return jsonify({'id': member_id, 'message': 'ä¼šå‘˜åˆ›å»ºæˆåŠŸ'})

# è·å–ç‰¹å®šä¼šå‘˜ä¿¡æ¯
@app.route('/api/members/<int:member_id>', methods=['GET'])
def get_member(member_id):
    conn = get_db_connection()
    member = conn.execute('SELECT * FROM members WHERE id = ?', (member_id,)).fetchone()
    conn.close()
    
    if member:
        return jsonify(dict(member))
    else:
        return jsonify({'error': 'ä¼šå‘˜ä¸å­˜åœ¨'}), 404

# æ›´æ–°ä¼šå‘˜ä¿¡æ¯
@app.route('/api/members/<int:member_id>', methods=['PUT'])
def update_member(member_id):
    data = request.json
    conn = get_db_connection()
    
    query = '''
        UPDATE members 
        SET name = ?, phone = ?, email = ?, gender = ?, birth_date = ?, status = ?
        WHERE id = ?
    '''
    
    conn.execute(query, (
        data['name'],
        data.get('phone', ''),
        data.get('email', ''),
        data.get('gender', ''),
        data.get('birth_date', ''),
        data.get('status', 'active'),
        member_id
    ))
    
    conn.commit()
    conn.close()
    
    return jsonify({'message': 'ä¼šå‘˜ä¿¡æ¯æ›´æ–°æˆåŠŸ'})

# åˆ é™¤ä¼šå‘˜
@app.route('/api/members/<int:member_id>', methods=['DELETE'])
def delete_member(member_id):
    conn = get_db_connection()
    
    # æ£€æŸ¥æ˜¯å¦æœ‰å…³è”æ•°æ®
    enrollments = conn.execute('SELECT COUNT(*) as count FROM course_enrollments WHERE member_id = ?', (member_id,)).fetchone()
    cards = conn.execute('SELECT COUNT(*) as count FROM member_cards WHERE member_id = ?', (member_id,)).fetchone()
    assignments = conn.execute('SELECT COUNT(*) as count FROM trainer_assignments WHERE member_id = ?', (member_id,)).fetchone()
    
    if enrollments['count'] > 0 or cards['count'] > 0 or assignments['count'] > 0:
        conn.close()
        return jsonify({'error': 'è¯¥ä¼šå‘˜å­˜åœ¨ç›¸å…³è®°å½•ï¼Œæ— æ³•åˆ é™¤'}), 400
    
    conn.execute('DELETE FROM members WHERE id = ?', (member_id,))
    conn.commit()
    conn.close()
    
    return jsonify({'message': 'ä¼šå‘˜åˆ é™¤æˆåŠŸ'})
````

#### 2. æ•™ç»ƒç®¡ç†åŠŸèƒ½å®ç°

````python
# è·å–æ‰€æœ‰æ•™ç»ƒ
@app.route('/api/trainers', methods=['GET'])
def get_trainers():
    search = request.args.get('search', '')
    conn = get_db_connection()
    
    if search:
        query = '''
            SELECT * FROM trainers 
            WHERE name LIKE ? OR specialization LIKE ?
            ORDER BY hire_date DESC
        '''
        trainers = conn.execute(query, (f'%{search}%', f'%{search}%')).fetchall()
    else:
        trainers = conn.execute('SELECT * FROM trainers ORDER BY hire_date DESC').fetchall()
    
    conn.close()
    return jsonify([dict(trainer) for trainer in trainers])

# åˆ›å»ºæ–°æ•™ç»ƒ
@app.route('/api/trainers', methods=['POST'])
def create_trainer():
    data = request.json
    conn = get_db_connection()
    
    query = '''
        INSERT INTO trainers (name, phone, email, specialization, hire_date, status)
        VALUES (?, ?, ?, ?, ?, ?)
    '''
    
    cursor = conn.execute(query, (
        data['name'],
        data.get('phone', ''),
        data.get('email', ''),
        data.get('specialization', ''),
        data.get('hire_date', datetime.now().strftime('%Y-%m-%d')),
        data.get('status', 'active')
    ))
    
    conn.commit()
    trainer_id = cursor.lastrowid
    conn.close()
    
    return jsonify({'id': trainer_id, 'message': 'æ•™ç»ƒåˆ›å»ºæˆåŠŸ'})

# è·å–æ•™ç»ƒçš„è¯¾ç¨‹åˆ†é…
@app.route('/api/trainers/<int:trainer_id>/courses', methods=['GET'])
def get_trainer_courses(trainer_id):
    conn = get_db_connection()
    
    query = '''
        SELECT 
            tc.id,
            tc.trainer_id,
            tc.course_id,
            tc.assignment_date,
            tc.status,
            c.name as course_name,
            c.description as course_description,
            c.duration,
            c.price
        FROM trainer_courses tc
        JOIN courses c ON tc.course_id = c.id
        WHERE tc.trainer_id = ?
        ORDER BY tc.assignment_date DESC
    '''
    
    courses = conn.execute(query, (trainer_id,)).fetchall()
    conn.close()
    
    return jsonify([dict(course) for course in courses])

# è·å–æ•™ç»ƒçš„ä¼šå‘˜æŒ‡æ´¾
@app.route('/api/trainers/<int:trainer_id>/members', methods=['GET'])
def get_trainer_members(trainer_id):
    conn = get_db_connection()
    
    query = '''
        SELECT 
            ta.id,
            ta.trainer_id,
            ta.member_id,
            ta.assignment_date,
            ta.assignment_type,
            ta.status,
            m.name as member_name,
            m.phone as member_phone,
            m.email as member_email
        FROM trainer_assignments ta
        JOIN members m ON ta.member_id = m.id
        WHERE ta.trainer_id = ?
        ORDER BY ta.assignment_date DESC
    '''
    
    assignments = conn.execute(query, (trainer_id,)).fetchall()
    conn.close()
    
    return jsonify([dict(assignment) for assignment in assignments])
````

#### 3. è¯¾ç¨‹ç®¡ç†åŠŸèƒ½å®ç°

````python
# è·å–æ‰€æœ‰è¯¾ç¨‹
@app.route('/api/courses', methods=['GET'])
def get_courses():
    search = request.args.get('search', '')
    conn = get_db_connection()
    
    if search:
        query = '''
            SELECT * FROM courses 
            WHERE name LIKE ? OR description LIKE ?
            ORDER BY name
        '''
        courses = conn.execute(query, (f'%{search}%', f'%{search}%')).fetchall()
    else:
        courses = conn.execute('SELECT * FROM courses ORDER BY name').fetchall()
    
    conn.close()
    return jsonify([dict(course) for course in courses])

# åˆ›å»ºæ–°è¯¾ç¨‹
@app.route('/api/courses', methods=['POST'])
def create_course():
    data = request.json
    conn = get_db_connection()
    
    query = '''
        INSERT INTO courses (name, description, duration, price, status)
        VALUES (?, ?, ?, ?, ?)
    '''
    
    cursor = conn.execute(query, (
        data['name'],
        data.get('description', ''),
        data.get('duration', 60),
        data.get('price', 0.0),
        data.get('status', 'active')
    ))
    
    conn.commit()
    course_id = cursor.lastrowid
    conn.close()
    
    return jsonify({'id': course_id, 'message': 'è¯¾ç¨‹åˆ›å»ºæˆåŠŸ'})
````

#### 4. ä¼šå‘˜è¯¦æƒ…ç®¡ç†åŠŸèƒ½

##### **ä¼šå‘˜å¡ç®¡ç†**

````python
# è·å–ä¼šå‘˜çš„ä¼šå‘˜å¡
@app.route('/api/members/<int:member_id>/cards', methods=['GET'])
def get_member_cards(member_id):
    conn = get_db_connection()
    
    query = '''
        SELECT 
            mc.id,
            mc.member_id,
            mc.card_type_id,
            mc.purchase_date,
            mc.expiry_date,
            mc.status,
            ct.name as card_type_name,
            ct.price as card_type_price,
            ct.validity_days,
            ct.description as card_type_description
        FROM member_cards mc
        JOIN card_types ct ON mc.card_type_id = ct.id
        WHERE mc.member_id = ?
        ORDER BY mc.purchase_date DESC
    '''
    
    cards = conn.execute(query, (member_id,)).fetchall()
    conn.close()
    
    return jsonify([dict(card) for card in cards])

# ä¸ºä¼šå‘˜æ·»åŠ ä¼šå‘˜å¡
@app.route('/api/members/<int:member_id>/cards', methods=['POST'])
def create_member_card(member_id):
    data = request.json
    conn = get_db_connection()
    
    # è·å–å¡ç±»å‹ä¿¡æ¯ä»¥è®¡ç®—åˆ°æœŸæ—¥æœŸ
    card_type = conn.execute('SELECT * FROM card_types WHERE id = ?', (data['card_type_id'],)).fetchone()
    
    if not card_type:
        conn.close()
        return jsonify({'error': 'ä¼šå‘˜å¡ç±»å‹ä¸å­˜åœ¨'}), 404
    
    # è®¡ç®—åˆ°æœŸæ—¥æœŸ
    from datetime import datetime, timedelta
    purchase_date = datetime.strptime(data['purchase_date'], '%Y-%m-%d')
    expiry_date = purchase_date + timedelta(days=card_type['validity_days'])
    
    query = '''
        INSERT INTO member_cards (member_id, card_type_id, purchase_date, expiry_date, status)
        VALUES (?, ?, ?, ?, ?)
    '''
    
    cursor = conn.execute(query, (
        member_id,
        data['card_type_id'],
        data['purchase_date'],
        expiry_date.strftime('%Y-%m-%d'),
        data.get('status', 'active')
    ))
    
    conn.commit()
    card_id = cursor.lastrowid
    conn.close()
    
    return jsonify({'id': card_id, 'message': 'ä¼šå‘˜å¡åˆ›å»ºæˆåŠŸ'})
````

##### **è¯¾ç¨‹æŠ¥åç®¡ç†**

````python
# è·å–ä¼šå‘˜çš„è¯¾ç¨‹æŠ¥å
@app.route('/api/members/<int:member_id>/enrollments', methods=['GET'])
def get_member_enrollments(member_id):
    conn = get_db_connection()
    
    query = '''
        SELECT 
            ce.id,
            ce.member_id,
            ce.course_id,
            ce.enrollment_date,
            ce.status,
            c.name as course_name,
            c.description as course_description,
            c.duration,
            c.price
        FROM course_enrollments ce
        JOIN courses c ON ce.course_id = c.id
        WHERE ce.member_id = ?
        ORDER BY ce.enrollment_date DESC
    '''
    
    enrollments = conn.execute(query, (member_id,)).fetchall()
    conn.close()
    
    return jsonify([dict(enrollment) for enrollment in enrollments])

# ä¸ºä¼šå‘˜æ·»åŠ è¯¾ç¨‹æŠ¥å
@app.route('/api/members/<int:member_id>/enrollments', methods=['POST'])
def create_member_enrollment(member_id):
    data = request.json
    conn = get_db_connection()
    
    # æ£€æŸ¥æ˜¯å¦å·²ç»æŠ¥åè¯¥è¯¾ç¨‹
    existing = conn.execute('''
        SELECT * FROM course_enrollments 
        WHERE member_id = ? AND course_id = ? AND status IN ('enrolled', 'in_progress')
    ''', (member_id, data['course_id'])).fetchone()
    
    if existing:
        conn.close()
        return jsonify({'error': 'å·²ç»æŠ¥åè¯¥è¯¾ç¨‹'}), 400
    
    query = '''
        INSERT INTO course_enrollments (member_id, course_id, enrollment_date, status)
        VALUES (?, ?, ?, ?)
    '''
    
    cursor = conn.execute(query, (
        member_id,
        data['course_id'],
        data.get('enrollment_date', datetime.now().strftime('%Y-%m-%d')),
        data.get('status', 'enrolled')
    ))
    
    conn.commit()
    enrollment_id = cursor.lastrowid
    conn.close()
    
    return jsonify({'id': enrollment_id, 'message': 'è¯¾ç¨‹æŠ¥åæˆåŠŸ'})
````

##### **æ•™ç»ƒæŒ‡æ´¾ç®¡ç†**

````python
# è·å–ä¼šå‘˜çš„æ•™ç»ƒæŒ‡æ´¾
@app.route('/api/members/<int:member_id>/assignments', methods=['GET'])
def get_member_assignments(member_id):
    conn = get_db_connection()
    
    query = '''
        SELECT 
            ta.id,
            ta.trainer_id,
            ta.member_id,
            ta.assignment_date,
            ta.assignment_type,
            ta.status,
            t.name as trainer_name,
            t.specialization as trainer_specialization,
            t.phone as trainer_phone
        FROM trainer_assignments ta
        JOIN trainers t ON ta.trainer_id = t.id
        WHERE ta.member_id = ?
        ORDER BY ta.assignment_date DESC
    '''
    
    assignments = conn.execute(query, (member_id,)).fetchall()
    conn.close()
    
    return jsonify([dict(assignment) for assignment in assignments])

# ä¸ºä¼šå‘˜æ·»åŠ æ•™ç»ƒæŒ‡æ´¾
@app.route('/api/members/<int:member_id>/assignments', methods=['POST'])
def create_member_assignment(member_id):
    data = request.json
    conn = get_db_connection()
    
    query = '''
        INSERT INTO trainer_assignments (trainer_id, member_id, assignment_date, assignment_type, status)
        VALUES (?, ?, ?, ?, ?)
    '''
    
    cursor = conn.execute(query, (
        data['trainer_id'],
        member_id,
        data.get('assignment_date', datetime.now().strftime('%Y-%m-%d')),
        data['assignment_type'],
        data.get('status', 'active')
    ))
    
    conn.commit()
    assignment_id = cursor.lastrowid
    conn.close()
    
    return jsonify({'id': assignment_id, 'message': 'æ•™ç»ƒæŒ‡æ´¾æˆåŠŸ'})
````

#### 5. ä¼šå‘˜å¡ç±»å‹ç®¡ç†

````python
# è·å–æ‰€æœ‰ä¼šå‘˜å¡ç±»å‹
@app.route('/api/card-types', methods=['GET'])
def get_card_types():
    search = request.args.get('search', '')
    conn = get_db_connection()
    
    if search:
        query = '''
            SELECT * FROM card_types 
            WHERE name LIKE ? OR description LIKE ?
            ORDER BY price
        '''
        card_types = conn.execute(query, (f'%{search}%', f'%{search}%')).fetchall()
    else:
        card_types = conn.execute('SELECT * FROM card_types ORDER BY price').fetchall()
    
    conn.close()
    return jsonify([dict(card_type) for card_type in card_types])

# åˆ›å»ºæ–°çš„ä¼šå‘˜å¡ç±»å‹
@app.route('/api/card-types', methods=['POST'])
def create_card_type():
    data = request.json
    conn = get_db_connection()
    
    query = '''
        INSERT INTO card_types (name, price, validity_days, description)
        VALUES (?, ?, ?, ?)
    '''
    
    cursor = conn.execute(query, (
        data['name'],
        data['price'],
        data['validity_days'],
        data.get('description', '')
    ))
    
    conn.commit()
    card_type_id = cursor.lastrowid
    conn.close()
    
    return jsonify({'id': card_type_id, 'message': 'ä¼šå‘˜å¡ç±»å‹åˆ›å»ºæˆåŠŸ'})
````

#### 6. ç»Ÿè®¡æŸ¥è¯¢åŠŸèƒ½

````python
# è·å–ä»ªè¡¨æ¿ç»Ÿè®¡æ•°æ®
@app.route('/api/dashboard/stats', methods=['GET'])
def get_dashboard_stats():
    conn = get_db_connection()
    
    # ç»Ÿè®¡æ´»è·ƒä¼šå‘˜æ•°é‡
    active_members = conn.execute("SELECT COUNT(*) as count FROM members WHERE status = 'active'").fetchone()
    
    # ç»Ÿè®¡æ´»è·ƒæ•™ç»ƒæ•°é‡
    active_trainers = conn.execute("SELECT COUNT(*) as count FROM trainers WHERE status = 'active'").fetchone()
    
    # ç»Ÿè®¡æ´»è·ƒè¯¾ç¨‹æ•°é‡
    active_courses = conn.execute("SELECT COUNT(*) as count FROM courses WHERE status = 'active'").fetchone()
    
    # ç»Ÿè®¡æ€»æ”¶å…¥ï¼ˆåŸºäºä¼šå‘˜å¡é”€å”®ï¼‰
    total_revenue = conn.execute('''
        SELECT COALESCE(SUM(ct.price), 0) as total
        FROM member_cards mc
        JOIN card_types ct ON mc.card_type_id = ct.id
        WHERE mc.status = 'active'
    ''').fetchone()
    
    # ç»Ÿè®¡æœ¬æœˆæ–°å¢ä¼šå‘˜
    monthly_new_members = conn.execute('''
        SELECT COUNT(*) as count FROM members 
        WHERE strftime('%Y-%m', join_date) = strftime('%Y-%m', 'now')
    ''').fetchone()
    
    conn.close()
    
    return jsonify({
        'activeMembers': active_members['count'],
        'activeTrainers': active_trainers['count'],
        'activeCourses': active_courses['count'],
        'totalRevenue': total_revenue['total'],
        'monthlyNewMembers': monthly_new_members['count']
    })

# è·å–è¯¾ç¨‹æŠ¥åç»Ÿè®¡
@app.route('/api/stats/course-enrollments', methods=['GET'])
def get_course_enrollment_stats():
    conn = get_db_connection()
    
    query = '''
        SELECT 
            c.name as course_name,
            COUNT(ce.id) as enrollment_count,
            SUM(c.price) as total_revenue
        FROM courses c
        LEFT JOIN course_enrollments ce ON c.id = ce.course_id
        WHERE c.status = 'active'
        GROUP BY c.id, c.name
        ORDER BY enrollment_count DESC
    '''
    
    stats = conn.execute(query).fetchall()
    conn.close()
    
    return jsonify([dict(stat) for stat in stats])
````

### 5.3 å‰ç«¯å®ç°åŠåŠŸèƒ½æ¼”ç¤º

#### 1. APIå®¢æˆ·ç«¯å°è£…

````javascript
// filepath: frontend/scripts/api.js
class GymAPI {
    constructor() {
        this.baseURL = '/api';
    }

    async request(endpoint, options = {}) {
        const url = `${this.baseURL}${endpoint}`;
        const config = {
            headers: {
                'Content-Type': 'application/json',
                ...options.headers
            },
            ...options
        };

        try {
            const response = await fetch(url, config);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return await response.json();
        } catch (error) {
            console.error('API request failed:', error);
            throw error;
        }
    }

    // ä¼šå‘˜ç›¸å…³API
    async getMembers(search = '') {
        const params = search ? `?search=${encodeURIComponent(search)}` : '';
        return this.request(`/members${params}`);
    }

    async getMember(id) {
        return this.request(`/members/${id}`);
    }

    async createMember(memberData) {
        return this.request('/members', {
            method: 'POST',
            body: JSON.stringify(memberData)
        });
    }

    async updateMember(id, memberData) {
        return this.request(`/members/${id}`, {
            method: 'PUT',
            body: JSON.stringify(memberData)
        });
    }

    async deleteMember(id) {
        return this.request(`/members/${id}`, {
            method: 'DELETE'
        });
    }

    // ä¼šå‘˜è¯¦æƒ…ç›¸å…³API
    async getMemberCards(memberId) {
        return this.request(`/members/${memberId}/cards`);
    }

    async createMemberCard(memberId, cardData) {
        return this.request(`/members/${memberId}/cards`, {
            method: 'POST',
            body: JSON.stringify(cardData)
        });
    }

    async getMemberEnrollments(memberId) {
        return this.request(`/members/${memberId}/enrollments`);
    }

    async createMemberEnrollment(memberId, enrollmentData) {
        return this.request(`/members/${memberId}/enrollments`, {
            method: 'POST',
            body: JSON.stringify(enrollmentData)
        });
    }

    async getMemberAssignments(memberId) {
        return this.request(`/members/${memberId}/assignments`);
    }

    async createMemberAssignment(memberId, assignmentData) {
        return this.request(`/members/${memberId}/assignments`, {
            method: 'POST',
            body: JSON.stringify(assignmentData)
        });
    }

    // æ•™ç»ƒç›¸å…³API
    async getTrainers(search = '') {
        const params = search ? `?search=${encodeURIComponent(search)}` : '';
        return this.request(`/trainers${params}`);
    }

    async getTrainer(id) {
        return this.request(`/trainers/${id}`);
    }

    async createTrainer(trainerData) {
        return this.request('/trainers', {
            method: 'POST',
            body: JSON.stringify(trainerData)
        });
    }

    async getTrainerCourses(trainerId) {
        return this.request(`/trainers/${trainerId}/courses`);
    }

    async getTrainerMembers(trainerId) {
        return this.request(`/trainers/${trainerId}/members`);
    }

    // è¯¾ç¨‹ç›¸å…³API
    async getCourses(search = '') {
        const params = search ? `?search=${encodeURIComponent(search)}` : '';
        return this.request(`/courses${params}`);
    }

    async createCourse(courseData) {
        return this.request('/courses', {
            method: 'POST',
            body: JSON.stringify(courseData)
        });
    }

    // ä¼šå‘˜å¡ç±»å‹ç›¸å…³API
    async getCardTypes(search = '') {
        const params = search ? `?search=${encodeURIComponent(search)}` : '';
        return this.request(`/card-types${params}`);
    }

    async createCardType(cardTypeData) {
        return this.request('/card-types', {
            method: 'POST',
            body: JSON.stringify(cardTypeData)
        });
    }

    // ç»Ÿè®¡ç›¸å…³API
    async getDashboardStats() {
        return this.request('/dashboard/stats');
    }

    async getCourseEnrollmentStats() {
        return this.request('/stats/course-enrollments');
    }
}

// åˆ›å»ºå…¨å±€APIå®ä¾‹
const api = new GymAPI();
````

#### 2. ä¸»è¦åŠŸèƒ½å’Œå¯¼èˆªç®¡ç†

![image-20250612132835432](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612132835432.png)

````javascript
// filepath: frontend/scripts/main.js
document.addEventListener('DOMContentLoaded', function() {
    initializeApp();
});

function initializeApp() {
    setupNavigation();
    loadDashboard();
}

function setupNavigation() {
    const navTabs = document.querySelectorAll('.nav-tab');
    navTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const tabName = this.getAttribute('data-tab');
            switchTab(tabName);
            
            // æ›´æ–°æ´»è·ƒæ ‡ç­¾æ ·å¼
            navTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
        });
    });
}

function switchTab(tabName) {
    const mainContent = document.getElementById('main-content');
    
    switch(tabName) {
        case 'dashboard':
            loadDashboard();
            break;
        case 'members':
            loadMembersTab();
            break;
        case 'trainers':
            loadTrainersTab();
            break;
        case 'courses':
            loadCoursesTab();
            break;
        case 'card-types':
            loadCardTypesTab();
            break;
        default:
            loadDashboard();
    }
}

async function loadDashboard() {
    const mainContent = document.getElementById('main-content');
    mainContent.innerHTML = `
        <div class="dashboard">
            <h2>å¥èº«æˆ¿ç®¡ç†ç³»ç»Ÿä»ªè¡¨æ¿</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>æ´»è·ƒä¼šå‘˜</h3>
                    <div class="stat-number" id="activeMembersCount">-</div>
                </div>
                <div class="stat-card">
                    <h3>æ´»è·ƒæ•™ç»ƒ</h3>
                    <div class="stat-number" id="activeTrainersCount">-</div>
                </div>
                <div class="stat-card">
                    <h3>æ´»è·ƒè¯¾ç¨‹</h3>
                    <div class="stat-number" id="activeCoursesCount">-</div>
                </div>
                <div class="stat-card">
                    <h3>æ€»æ”¶å…¥</h3>
                    <div class="stat-number" id="totalRevenueCount">-</div>
                </div>
            </div>
        </div>
    `;
    
    await loadDashboardStats();
}

async function loadDashboardStats() {
    try {
        const stats = await api.getDashboardStats();
        document.getElementById('activeMembersCount').textContent = stats.activeMembers;
        document.getElementById('activeTrainersCount').textContent = stats.activeTrainers;
        document.getElementById('activeCoursesCount').textContent = stats.activeCourses;
        document.getElementById('totalRevenueCount').textContent = `Â¥${stats.totalRevenue || 0}`;
    } catch (error) {
        showMessage('åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥', 'error');
        console.error('Failed to load dashboard stats:', error);
    }
}

function loadMembersTab() {
    const mainContent = document.getElementById('main-content');
    mainContent.innerHTML = `
        <div class="members-section">
            <div class="section-header">
                <h2>ä¼šå‘˜ç®¡ç†</h2>
                <button class="btn btn-primary" onclick="showMemberForm()">æ·»åŠ ä¼šå‘˜</button>
            </div>
            <div class="search-bar">
                <input type="text" id="memberSearch" placeholder="æœç´¢ä¼šå‘˜å§“åã€ç”µè¯æˆ–é‚®ç®±...">
                <button onclick="searchMembers()">æœç´¢</button>
            </div>
            <div id="membersContainer" class="content-grid">
                <!-- ä¼šå‘˜åˆ—è¡¨å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </div>
        </div>
    `;
    
    loadMembers();
}

// æ¨¡æ€æ¡†ç®¡ç†
function showModal(title, content) {
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modalTitle');
    const modalBody = document.getElementById('modalBody');
    
    modalTitle.textContent = title;
    modalBody.innerHTML = content;
    modal.style.display = 'block';
}

function closeModal() {
    const modal = document.getElementById('modal');
    modal.style.display = 'none';
}

// æ¶ˆæ¯æç¤ºç³»ç»Ÿ
function showMessage(message, type = 'success') {
    const messageDiv = document.createElement('div');
    messageDiv.className = `message message-${type}`;
    messageDiv.textContent = message;
    
    document.body.appendChild(messageDiv);
    
    setTimeout(() => {
        messageDiv.remove();
    }, 3000);
}

// æ ‡ç­¾é¡µåˆ‡æ¢åŠŸèƒ½
function showTab(tabName) {
    const tabs = document.querySelectorAll('.detail-tab');
    const contents = document.querySelectorAll('.detail-content');
    
    tabs.forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-tab') === tabName) {
            tab.classList.add('active');
        }
    });
    
    contents.forEach(content => {
        content.style.display = 'none';
        if (content.id === `${tabName}Content`) {
            content.style.display = 'block';
        }
    });
}

function showTrainerTab(tabName) {
    const tabs = document.querySelectorAll('.trainer-detail-tab');
    const contents = document.querySelectorAll('.trainer-detail-content');
    
    tabs.forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-tab') === tabName) {
            tab.classList.add('active');
        }
    });
    
    contents.forEach(content => {
        content.style.display = 'none';
        if (content.id === `trainer${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Content`) {
            content.style.display = 'block';
        }
    });
}
````

#### 3. ä¼šå‘˜ç®¡ç†æ¨¡å—

##### **æ’å…¥**

````SQL
-- æ’å…¥ä¼šå‘˜æ•°æ®
INSERT INTO members (name, gender, birth_date, phone, emergency_contact_name, emergency_contact_phone, health_notes, join_date, status) VALUES
('å¼ ä¸‰', 'ç”·', '1990-05-15', '13812345678', 'å¼ æ¯', '13912345678', 'æ— ç‰¹æ®Šå¥åº·é—®é¢˜', '2024-01-15', 'active'),
('æå››', 'å¥³', '1992-08-22', '13923456789', 'æçˆ¶', '13823456789', 'è½»å¾®è…°æ¤é—´ç›˜çªå‡º', '2024-02-01', 'active'),
('ç‹äº”', 'ç”·', '1988-12-10', '15034567890', 'ç‹å¦»', '15134567890', 'é«˜è¡€å‹ï¼Œéœ€è¦é€‚åº¦è¿åŠ¨', '2024-01-20', 'active'),
('èµµå…­', 'å¥³', '1995-03-08', '15145678901', 'èµµå¤«', '15245678901', 'æ— ç‰¹æ®Šå¥åº·é—®é¢˜', '2024-02-15', 'active'),
('é’±ä¸ƒ', 'ç”·', '1991-07-25', '13656789012', 'é’±çˆ¶', '13756789012', 'è†ç›–æœ‰æ—§ä¼¤ï¼Œé¿å…å‰§çƒˆè¿åŠ¨', '2024-01-30', 'active'),
('å­™å…«', 'å¥³', '1993-11-18', '13767890123', 'å­™æ¯', '13867890123', 'æ— ç‰¹æ®Šå¥åº·é—®é¢˜', '2024-02-10', 'active'),
('å‘¨ä¹', 'ç”·', '1989-04-03', '15878901234', 'å‘¨å¦»', '15978901234', 'ç³–å°¿ç—…ï¼Œéœ€è¦ç›‘æ§è¡€ç³–', '2024-01-25', 'active'),
('å´å', 'å¥³', '1994-09-14', '15989012345', 'å´çˆ¶', '16089012345', 'æ— ç‰¹æ®Šå¥åº·é—®é¢˜', '2024-02-20', 'active');
````

![image-20250611193203286](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250611193203286.png)

##### **æŸ¥è¯¢**

![image-20250611193941758](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250611193941758.png)

##### **åˆ é™¤ï¼ˆé€»è¾‘åˆ é™¤ï¼Œè½¯åˆ é™¤ï¼‰**

**åˆ é™¤å‰**

![image-20250611194054969](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250611194054969.png)

**åˆ é™¤å**

![image-20250611194140049](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250611194140049.png)

````javascript
// filepath: frontend/scripts/members.js
async function loadMembers() {
    try {
        const members = await api.getMembers();
        displayMembers(members);
    } catch (error) {
        showMessage('åŠ è½½ä¼šå‘˜åˆ—è¡¨å¤±è´¥', 'error');
        console.error('Failed to load members:', error);
    }
}

async function searchMembers() {
    const searchTerm = document.getElementById('memberSearch').value;
    try {
        const members = await api.getMembers(searchTerm);
        displayMembers(members);
    } catch (error) {
        showMessage('æœç´¢ä¼šå‘˜å¤±è´¥', 'error');
        console.error('Failed to search members:', error);
    }
}

function displayMembers(members) {
    const container = document.getElementById('membersContainer');
    
    if (members.length === 0) {
        container.innerHTML = '<div class="no-data">æš‚æ— ä¼šå‘˜æ•°æ®</div>';
        return;
    }
    
    container.innerHTML = members.map(member => `
        <div class="card member-card">
            <div class="card-header">
                <h3>${member.name}</h3>
                <span class="status status-${member.status}">${getStatusText(member.status)}</span>
            </div>
            <div class="card-body">
                <p><strong>ç”µè¯:</strong> ${member.phone || 'æœªå¡«å†™'}</p>
                <p><strong>é‚®ç®±:</strong> ${member.email || 'æœªå¡«å†™'}</p>
                <p><strong>æ€§åˆ«:</strong> ${member.gender || 'æœªå¡«å†™'}</p>
                <p><strong>å…¥ä¼šæ—¥æœŸ:</strong> ${member.join_date || 'æœªçŸ¥'}</p>
            </div>
            <div class="card-actions">
                <button class="btn btn-info" onclick="showMemberDetail(${member.id})">æŸ¥çœ‹è¯¦æƒ…</button>
                <button class="btn btn-warning" onclick="editMember(${member.id})">ç¼–è¾‘</button>
                <button class="btn btn-danger" onclick="deleteMember(${member.id})">åˆ é™¤</button>
            </div>
        </div>
    `).join('');
}

function getStatusText(status) {
    const statusMap = {
        'active': 'æ´»è·ƒ',
        'inactive': 'éæ´»è·ƒ',
        'suspended': 'æš‚åœ'
    };
    return statusMap[status] || status;
}

function showMemberForm(memberId = null) {
    const isEdit = memberId !== null;
    const title = isEdit ? 'ç¼–è¾‘ä¼šå‘˜' : 'æ·»åŠ ä¼šå‘˜';
    
    const content = `
        <form id="memberForm">
            <input type="hidden" id="memberId" value="${memberId || ''}">
            <div class="form-group">
                <label for="memberName">å§“å *</label>
                <input type="text" id="memberName" required>
            </div>
            <div class="form-group">
                <label for="memberPhone">ç”µè¯</label>
                <input type="tel" id="memberPhone">
            </div>
            <div class="form-group">
                <label for="memberEmail">é‚®ç®±</label>
                <input type="email" id="memberEmail">
            </div>
            <div class="form-group">
                <label for="memberGender">æ€§åˆ«</label>
                <select id="memberGender">
                    <option value="">è¯·é€‰æ‹©</option>
                    <option value="ç”·">ç”·</option>
                    <option value="å¥³">å¥³</option>
                    <option value="å…¶ä»–">å…¶ä»–</option>
                </select>
            </div>
            <div class="form-group">
                <label for="memberBirthDate">å‡ºç”Ÿæ—¥æœŸ</label>
                <input type="date" id="memberBirthDate">
            </div>
            <div class="form-group">
                <label for="memberStatus">çŠ¶æ€</label>
                <select id="memberStatus">
                    <option value="active">æ´»è·ƒ</option>
                    <option value="inactive">éæ´»è·ƒ</option>
                    <option value="suspended">æš‚åœ</option>
                </select>
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                <button type="submit" class="btn btn-primary">ä¿å­˜</button>
            </div>
        </form>
    `;
    
    showModal(title, content);
    
    // å¦‚æœæ˜¯ç¼–è¾‘æ¨¡å¼ï¼ŒåŠ è½½ä¼šå‘˜æ•°æ®
    if (isEdit) {
        loadMemberForEdit(memberId);
    }
    
    // ç»‘å®šè¡¨å•æäº¤äº‹ä»¶
    document.getElementById('memberForm').addEventListener('submit', saveMember);
}

async function loadMemberForEdit(memberId) {
    try {
        const member = await api.getMember(memberId);
        document.getElementById('memberName').value = member.name || '';
        document.getElementById('memberPhone').value = member.phone || '';
        document.getElementById('memberEmail').value = member.email || '';
        document.getElementById('memberGender').value = member.gender || '';
        document.getElementById('memberBirthDate').value = member.birth_date || '';
        document.getElementById('memberStatus').value = member.status || 'active';
    } catch (error) {
        showMessage('åŠ è½½ä¼šå‘˜ä¿¡æ¯å¤±è´¥', 'error');
        console.error('Failed to load member for edit:', error);
    }
}

async function saveMember(event) {
    event.preventDefault();
    
    const form = event.target;
    const formData = new FormData(form);
    const memberId = document.getElementById('memberId').value;
    
    const memberData = {
        name: formData.get('memberName') || document.getElementById('memberName').value,
        phone: document.getElementById('memberPhone').value,
        email: document.getElementById('memberEmail').value,
        gender: document.getElementById('memberGender').value,
        birth_date: document.getElementById('memberBirthDate').value,
        status: document.getElementById('memberStatus').value,
        join_date: new Date().toISOString().split('T')[0]
    };
    
    try {
        if (memberId) {
            await api.updateMember(memberId, memberData);
            showMessage('ä¼šå‘˜ä¿¡æ¯æ›´æ–°æˆåŠŸ', 'success');
        } else {
            await api.createMember(memberData);
            showMessage('ä¼šå‘˜åˆ›å»ºæˆåŠŸ', 'success');
        }
        
        closeModal();
        loadMembers();
    } catch (error) {
        showMessage('ä¿å­˜ä¼šå‘˜ä¿¡æ¯å¤±è´¥', 'error');
        console.error('Failed to save member:', error);
    }
}

function editMember(memberId) {
    showMemberForm(memberId);
}

async function deleteMember(memberId) {
    if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä¼šå‘˜å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) {
        return;
    }
    
    try {
        await api.deleteMember(memberId);
        showMessage('ä¼šå‘˜åˆ é™¤æˆåŠŸ', 'success');
        loadMembers();
    } catch (error) {
        showMessage('åˆ é™¤ä¼šå‘˜å¤±è´¥', 'error');
        console.error('Failed to delete member:', error);
    }
}

function showMemberDetail(memberId) {
    loadMemberDetailTab(memberId);
}
````

#### 4. ä¼šå‘˜è¯¦æƒ…ç®¡ç†æ¨¡å—

##### **æ’å…¥**

````SQL
-- æ’å…¥ä¼šå‘˜å¡æ•°æ®
INSERT INTO member_cards (member_id, card_type_id, purchase_date, activation_date, expiry_date, status, notes) VALUES
(1, 2, '2024-01-15', '2024-01-16', '2024-04-16', 'active', 'æ­£å¸¸ä½¿ç”¨ä¸­'),
(2, 4, '2024-02-01', '2024-02-01', '2025-02-01', 'active', 'å¹´å¡ç”¨æˆ·ï¼Œäº«å—å…¨éƒ¨æƒç›Š'),
(3, 1, '2024-01-20', '2024-01-21', '2024-02-20', 'expired', 'å·²è¿‡æœŸï¼Œéœ€è¦ç»­è´¹'),
(3, 3, '2024-02-20', '2024-02-21', '2024-08-20', 'active', 'ç»­è´¹åŠå¹´å¡'),
(4, 5, '2024-02-15', '2024-02-15', '2025-02-15', 'active', 'VIPä¼šå‘˜ï¼Œäº«å—æœ€é«˜çº§åˆ«æœåŠ¡'),
(5, 1, '2024-01-30', '2024-01-31', '2024-03-01', 'active', 'æœˆå¡ç”¨æˆ·'),
(6, 2, '2024-02-10', '2024-02-10', '2024-05-11', 'active', 'å­£å¡ç”¨æˆ·'),
(7, 1, '2024-01-25', '2024-01-26', '2024-02-25', 'frozen', 'å› ç—…æš‚åœä½¿ç”¨'),
(8, 3, '2024-02-20', '2024-02-20', '2024-08-19', 'active', 'åŠå¹´å¡ç”¨æˆ·');

-- æ’å…¥ä¼šå‘˜è¯¾ç¨‹æŠ¥åæ•°æ®
INSERT INTO member_course_enrollments (member_id, course_id, enrollment_date, status, notes) VALUES
(1, 1, '2024-01-16', 'completed', 'å·²å®Œæˆåˆçº§ç‘œä¼½è¯¾ç¨‹'),
(1, 3, '2024-01-20', 'enrolled', 'æ­£åœ¨è¿›è¡ŒåŠ›é‡è®­ç»ƒåŸºç¡€'),
(2, 2, '2024-02-02', 'enrolled', 'å‚ä¸HIITè®­ç»ƒ'),
(2, 5, '2024-02-05', 'enrolled', 'å‚ä¸æ™®æ‹‰ææ ¸å¿ƒè®­ç»ƒ'),
(3, 1, '2024-01-22', 'completed', 'å®Œæˆåˆçº§ç‘œä¼½'),
(3, 4, '2024-02-21', 'enrolled', 'å‚ä¸æå‡»æœ‰æ°§'),
(4, 6, '2024-02-16', 'enrolled', 'VIPä¼šå‘˜å‚ä¸æ¸¸æ³³æŠ€å·§æå‡'),
(4, 8, '2024-02-18', 'enrolled', 'VIPä¼šå‘˜å‚ä¸CrossFitè®­ç»ƒ'),
(5, 2, '2024-02-01', 'enrolled', 'å‚ä¸HIITè®­ç»ƒ'),
(5, 7, '2024-02-03', 'completed', 'å®Œæˆæ‹‰ä¼¸æ”¾æ¾è¯¾ç¨‹'),
(6, 1, '2024-02-12', 'enrolled', 'å‚ä¸åˆçº§ç‘œä¼½'),
(6, 9, '2024-02-14', 'enrolled', 'å‚ä¸èˆè¹ˆå¥èº«'),
(7, 11, '2024-01-28', 'enrolled', 'å‚ä¸åº·å¤è®­ç»ƒ'),
(8, 3, '2024-02-22', 'enrolled', 'å‚ä¸åŠ›é‡è®­ç»ƒåŸºç¡€'),
(8, 5, '2024-02-23', 'enrolled', 'å‚ä¸æ™®æ‹‰ææ ¸å¿ƒè®­ç»ƒ');

-- æ’å…¥ä¼šå‘˜æ•™ç»ƒæŒ‡æ´¾æ•°æ®
INSERT INTO member_trainer_assignments (member_id, trainer_id, assignment_date, assignment_type, notes) VALUES
(1, 1, '2024-01-18', 'personal_training_package', 'è´­ä¹°10æ¬¡ç§æ•™è¯¾ç¨‹åŒ…'),
(2, 2, '2024-02-03', 'personal_training_package', 'å¹´å¡ç”¨æˆ·ï¼Œæ¯æœˆ2æ¬¡ç§æ•™'),
(3, 1, '2024-02-22', 'consultation', 'åŠ›é‡è®­ç»ƒå’¨è¯¢'),
(4, 6, '2024-02-17', 'personal_training_package', 'VIPä¼šå‘˜æ— é™ç§æ•™'),
(4, 2, '2024-02-19', 'personal_training_package', 'VIPä¼šå‘˜ç‘œä¼½ç§æ•™'),
(5, 3, '2024-02-02', 'personal_training_package', 'è´­ä¹°5æ¬¡æœ‰æ°§ç§æ•™'),
(6, 2, '2024-02-13', 'consultation', 'ç‘œä¼½å…¥é—¨æŒ‡å¯¼'),
(7, 8, '2024-01-28', 'personal_training_package', 'åº·å¤è®­ç»ƒä¸“é¡¹æŒ‡å¯¼'),
(8, 5, '2024-02-24', 'consultation', 'æ™®æ‹‰æåŠ¨ä½œæŒ‡å¯¼'),
(8, 1, '2024-02-25', 'personal_training_package', 'åŠ›é‡è®­ç»ƒç§æ•™');
````

![image-20250611194331060](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250611194331060.png)

![image-20250611194348208](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250611194348208.png)

![image-20250611194405465](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250611194405465.png)

##### **åˆ é™¤**

![image-20250611194502163](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250611194502163.png)

![image-20250611194627568](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250611194627568.png)

````javascript
// filepath: frontend/scripts/memberDetail.js
let currentMemberId = null;

async function loadMemberDetailTab(memberId) {
    currentMemberId = memberId;
    
    try {
        const member = await api.getMember(memberId);
        
        const mainContent = document.getElementById('main-content');
        mainContent.innerHTML = `
            <div class="member-detail">
                <div class="detail-header">
                    <button class="btn btn-secondary" onclick="loadMembersTab()">â† è¿”å›ä¼šå‘˜åˆ—è¡¨</button>
                    <h2>${member.name} - ä¼šå‘˜è¯¦æƒ…</h2>
                </div>
                
                <div class="member-info">
                    <div class="info-grid">
                        <div><strong>å§“å:</strong> ${member.name}</div>
                        <div><strong>ç”µè¯:</strong> ${member.phone || 'æœªå¡«å†™'}</div>
                        <div><strong>é‚®ç®±:</strong> ${member.email || 'æœªå¡«å†™'}</div>
                        <div><strong>æ€§åˆ«:</strong> ${member.gender || 'æœªå¡«å†™'}</div>
                        <div><strong>å…¥ä¼šæ—¥æœŸ:</strong> ${member.join_date || 'æœªçŸ¥'}</div>
                        <div><strong>çŠ¶æ€:</strong> <span class="status status-${member.status}">${getStatusText(member.status)}</span></div>
                    </div>
                </div>
                
                <div class="detail-tabs">
                    <button class="detail-tab active" data-tab="cards" onclick="showTab('cards')">ä¼šå‘˜å¡ç®¡ç†</button>
                    <button class="detail-tab" data-tab="enrollments" onclick="showTab('enrollments')">è¯¾ç¨‹æŠ¥å</button>
                    <button class="detail-tab" data-tab="assignments" onclick="showTab('assignments')">æ•™ç»ƒæŒ‡æ´¾</button>
                </div>
                
                <div id="cardsContent" class="detail-content">
                    <div class="content-header">
                        <h3>ä¼šå‘˜å¡ç®¡ç†</h3>
                        <button class="btn btn-primary" onclick="showMemberCardForm()">æ·»åŠ ä¼šå‘˜å¡</button>
                    </div>
                    <div id="memberCardsContainer"></div>
                </div>
                
                <div id="enrollmentsContent" class="detail-content" style="display: none;">
                    <div class="content-header">
                        <h3>è¯¾ç¨‹æŠ¥å</h3>
                        <button class="btn btn-primary" onclick="showMemberCourseForm()">æŠ¥åè¯¾ç¨‹</button>
                    </div>
                    <div id="memberEnrollmentsContainer"></div>
                </div>
                
                <div id="assignmentsContent" class="detail-content" style="display: none;">
                    <div class="content-header">
                        <h3>æ•™ç»ƒæŒ‡æ´¾</h// filepath: frontend/scripts/memberDetail.js
let currentMemberId = null;

async function loadMemberDetailTab(memberId) {
    currentMemberId = memberId;
    
    try {
        const member = await api.getMember(memberId);
        
        const mainContent = document.getElementById('main-content');
        mainContent.innerHTML = `
            <div class="member-detail">
                <div class="detail-header">
                    <button class="btn btn-secondary" onclick="loadMembersTab()">â† è¿”å›ä¼šå‘˜åˆ—è¡¨</button>
                    <h2>${member.name} - ä¼šå‘˜è¯¦æƒ…</h2>
                </div>
                
                <div class="member-info">
                    <div class="info-grid">
                        <div><strong>å§“å:</strong> ${member.name}</div>
                        <div><strong>ç”µè¯:</strong> ${member.phone || 'æœªå¡«å†™'}</div>
                        <div><strong>é‚®ç®±:</strong> ${member.email || 'æœªå¡«å†™'}</div>
                        <div><strong>æ€§åˆ«:</strong> ${member.gender || 'æœªå¡«å†™'}</div>
                        <div><strong>å…¥ä¼šæ—¥æœŸ:</strong> ${member.join_date || 'æœªçŸ¥'}</div>
                        <div><strong>çŠ¶æ€:</strong> <span class="status status-${member.status}">${getStatusText(member.status)}</span></div>
                    </div>
                </div>
                
                <div class="detail-tabs">
                    <button class="detail-tab active" data-tab="cards" onclick="showTab('cards')">ä¼šå‘˜å¡ç®¡ç†</button>
                    <button class="detail-tab" data-tab="enrollments" onclick="showTab('enrollments')">è¯¾ç¨‹æŠ¥å</button>
                    <button class="detail-tab" data-tab="assignments" onclick="showTab('assignments')">æ•™ç»ƒæŒ‡æ´¾</button>
                </div>
                
                <div id="cardsContent" class="detail-content">
                    <div class="content-header">
                        <h3>ä¼šå‘˜å¡ç®¡ç†</h3>
                        <button class="btn btn-primary" onclick="showMemberCardForm()">æ·»åŠ ä¼šå‘˜å¡</button>
                    </div>
                    <div id="memberCardsContainer"></div>
                </div>
                
                <div id="enrollmentsContent" class="detail-content" style="display: none;">
                    <div class="content-header">
                        <h3>è¯¾ç¨‹æŠ¥å</h3>
                        <button class="btn btn-primary" onclick="showMemberCourseForm()">æŠ¥åè¯¾ç¨‹</button>
                    </div>
                    <div id="memberEnrollmentsContainer"></div>
                </div>
                
                <div id="assignmentsContent" class="detail-content" style="display: none;">
                    <div class="content-header">
                        <h3>æ•™ç»ƒæŒ‡æ´¾</h
                        <button class="btn btn-primary" onclick="showMemberTrainerForm()">æŒ‡æ´¾æ•™ç»ƒ</button>
                    </div>
                    <div id="memberAssignmentsContainer"></div>
                </div>
            </div>
        `;
        
        // åŠ è½½é»˜è®¤æ ‡ç­¾é¡µå†…å®¹
        loadMemberCards(memberId);
    } catch (error) {
        showMessage('åŠ è½½ä¼šå‘˜è¯¦æƒ…å¤±è´¥', 'error');
        console.error('Failed to load member detail:', error);
    }
}

// ä¼šå‘˜å¡ç®¡ç†
async function loadMemberCards(memberId) {
    try {
        const cards = await api.getMemberCards(memberId);
        displayMemberCards(cards);
    } catch (error) {
        showMessage('åŠ è½½ä¼šå‘˜å¡å¤±è´¥', 'error');
        console.error('Failed to load member cards:', error);
    }
}

function displayMemberCards(cards) {
    const container = document.getElementById('memberCardsContainer');
    
    if (cards.length === 0) {
        container.innerHTML = '<div class="no-data">æš‚æ— ä¼šå‘˜å¡è®°å½•</div>';
        return;
    }
    
    container.innerHTML = cards.map(card => `
        <div class="card">
            <div class="card-header">
                <h4>${card.card_type_name}</h4>
                <span class="status status-${card.status}">${getCardStatusText(card.status)}</span>
            </div>
            <div class="card-body">
                <p><strong>ä»·æ ¼:</strong> Â¥${card.card_type_price}</p>
                <p><strong>è´­ä¹°æ—¥æœŸ:</strong> ${card.purchase_date}</p>
                <p><strong>åˆ°æœŸæ—¥æœŸ:</strong> ${card.expiry_date}</p>
                <p><strong>æœ‰æ•ˆæœŸ:</strong> ${card.validity_days}å¤©</p>
                <p><strong>æè¿°:</strong> ${card.card_type_description || 'æ— '}</p>
            </div>
        </div>
    `).join('');
}

function getCardStatusText(status) {
    const statusMap = {
        'active': 'æœ‰æ•ˆ',
        'expired': 'å·²è¿‡æœŸ',
        'suspended': 'å·²æš‚åœ'
    };
    return statusMap[status] || status;
}

async function showMemberCardForm() {
    try {
        const cardTypes = await api.getCardTypes();
        
        const content = `
            <form id="memberCardForm">
                <div class="form-group">
                    <label for="cardTypeId">ä¼šå‘˜å¡ç±»å‹ *</label>
                    <select id="cardTypeId" required>
                        <option value="">è¯·é€‰æ‹©ä¼šå‘˜å¡ç±»å‹</option>
                        ${cardTypes.map(type => `
                            <option value="${type.id}">${type.name} - Â¥${type.price} (${type.validity_days}å¤©)</option>
                        `).join('')}
                    </select>
                </div>
                <div class="form-group">
                    <label for="purchaseDate">è´­ä¹°æ—¥æœŸ *</label>
                    <input type="date" id="purchaseDate" value="${new Date().toISOString().split('T')[0]}" required>
                </div>
                <div class="form-group">
                    <label for="cardStatus">çŠ¶æ€</label>
                    <select id="cardStatus">
                        <option value="active">æœ‰æ•ˆ</option>
                        <option value="suspended">æš‚åœ</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜</button>
                </div>
            </form>
        `;
        
        showModal('æ·»åŠ ä¼šå‘˜å¡', content);
        document.getElementById('memberCardForm').addEventListener('submit', saveMemberCard);
    } catch (error) {
        showMessage('åŠ è½½ä¼šå‘˜å¡ç±»å‹å¤±è´¥', 'error');
        console.error('Failed to load card types:', error);
    }
}

async function saveMemberCard(event) {
    event.preventDefault();
    
    const cardData = {
        card_type_id: parseInt(document.getElementById('cardTypeId').value),
        purchase_date: document.getElementById('purchaseDate').value,
        status: document.getElementById('cardStatus').value
    };
    
    try {
        await api.createMemberCard(currentMemberId, cardData);
        showMessage('ä¼šå‘˜å¡æ·»åŠ æˆåŠŸ', 'success');
        closeModal();
        loadMemberCards(currentMemberId);
    } catch (error) {
        showMessage('æ·»åŠ ä¼šå‘˜å¡å¤±è´¥', 'error');
        console.error('Failed to save member card:', error);
    }
}

// è¯¾ç¨‹æŠ¥åç®¡ç†
async function loadMemberEnrollments(memberId) {
    try {
        const enrollments = await api.getMemberEnrollments(memberId);
        displayMemberEnrollments(enrollments);
    } catch (error) {
        showMessage('åŠ è½½è¯¾ç¨‹æŠ¥åå¤±è´¥', 'error');
        console.error('Failed to load member enrollments:', error);
    }
}

function displayMemberEnrollments(enrollments) {
    const container = document.getElementById('memberEnrollmentsContainer');
    
    if (enrollments.length === 0) {
        container.innerHTML = '<div class="no-data">æš‚æ— è¯¾ç¨‹æŠ¥åè®°å½•</div>';
        return;
    }
    
    container.innerHTML = enrollments.map(enrollment => `
        <div class="card">
            <div class="card-header">
                <h4>${enrollment.course_name}</h4>
                <span class="status status-${enrollment.status}">${getEnrollmentStatusText(enrollment.status)}</span>
            </div>
            <div class="card-body">
                <p><strong>è¯¾ç¨‹æè¿°:</strong> ${enrollment.course_description || 'æ— '}</p>
                <p><strong>è¯¾ç¨‹æ—¶é•¿:</strong> ${enrollment.duration}åˆ†é’Ÿ</p>
                <p><strong>è¯¾ç¨‹ä»·æ ¼:</strong> Â¥${enrollment.price}</p>
                <p><strong>æŠ¥åæ—¥æœŸ:</strong> ${enrollment.enrollment_date}</p>
            </div>
        </div>
    `).join('');
}

function getEnrollmentStatusText(status) {
    const statusMap = {
        'enrolled': 'å·²æŠ¥å',
        'in_progress': 'è¿›è¡Œä¸­',
        'completed': 'å·²å®Œæˆ',
        'cancelled': 'å·²å–æ¶ˆ'
    };
    return statusMap[status] || status;
}

async function showMemberCourseForm() {
    try {
        const courses = await api.getCourses();
        
        const content = `
            <form id="memberCourseForm">
                <div class="form-group">
                    <label for="courseId">è¯¾ç¨‹ *</label>
                    <select id="courseId" required>
                        <option value="">è¯·é€‰æ‹©è¯¾ç¨‹</option>
                        ${courses.filter(course => course.status === 'active').map(course => `
                            <option value="${course.id}">${course.name} - Â¥${course.price} (${course.duration}åˆ†é’Ÿ)</option>
                        `).join('')}
                    </select>
                </div>
                <div class="form-group">
                    <label for="enrollmentDate">æŠ¥åæ—¥æœŸ *</label>
                    <input type="date" id="enrollmentDate" value="${new Date().toISOString().split('T')[0]}" required>
                </div>
                <div class="form-group">
                    <label for="enrollmentStatus">çŠ¶æ€</label>
                    <select id="enrollmentStatus">
                        <option value="enrolled">å·²æŠ¥å</option>
                        <option value="in_progress">è¿›è¡Œä¸­</option>
                        <option value="completed">å·²å®Œæˆ</option>
                        <option value="cancelled">å·²å–æ¶ˆ</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜</button>
                </div>
            </form>
        `;
        
        showModal('è¯¾ç¨‹æŠ¥å', content);
        document.getElementById('memberCourseForm').addEventListener('submit', saveMemberCourseEnrollment);
    } catch (error) {
        showMessage('åŠ è½½è¯¾ç¨‹åˆ—è¡¨å¤±è´¥', 'error');
        console.error('Failed to load courses:', error);
    }
}

async function saveMemberCourseEnrollment(event) {
    event.preventDefault();
    
    const enrollmentData = {
        course_id: parseInt(document.getElementById('courseId').value),
        enrollment_date: document.getElementById('enrollmentDate').value,
        status: document.getElementById('enrollmentStatus').value
    };
    
    try {
        await api.createMemberEnrollment(currentMemberId, enrollmentData);
        showMessage('è¯¾ç¨‹æŠ¥åæˆåŠŸ', 'success');
        closeModal();
        loadMemberEnrollments(currentMemberId);
    } catch (error) {
        showMessage('è¯¾ç¨‹æŠ¥åå¤±è´¥', 'error');
        console.error('Failed to save member course enrollment:', error);
    }
}

// æ•™ç»ƒæŒ‡æ´¾ç®¡ç†
async function loadMemberAssignments(memberId) {
    try {
        const assignments = await api.getMemberAssignments(memberId);
        displayMemberAssignments(assignments);
    } catch (error) {
        showMessage('åŠ è½½æ•™ç»ƒæŒ‡æ´¾å¤±è´¥', 'error');
        console.error('Failed to load member assignments:', error);
    }
}

function displayMemberAssignments(assignments) {
    const container = document.getElementById('memberAssignmentsContainer');
    
    if (assignments.length === 0) {
        container.innerHTML = '<div class="no-data">æš‚æ— æ•™ç»ƒæŒ‡æ´¾è®°å½•</div>';
        return;
    }
    
    container.innerHTML = assignments.map(assignment => `
        <div class="card">
            <div class="card-header">
                <h4>${assignment.trainer_name}</h4>
                <span class="status status-${assignment.status}">${getAssignmentStatusText(assignment.status)}</span>
            </div>
            <div class="card-body">
                <p><strong>ä¸“ä¸šé¢†åŸŸ:</strong> ${assignment.trainer_specialization || 'æ— '}</p>
                <p><strong>æ•™ç»ƒç”µè¯:</strong> ${assignment.trainer_phone || 'æœªå¡«å†™'}</p>
                <p><strong>æŒ‡æ´¾ç±»å‹:</strong> ${getAssignmentTypeText(assignment.assignment_type)}</p>
                <p><strong>æŒ‡æ´¾æ—¥æœŸ:</strong> ${assignment.assignment_date}</p>
            </div>
        </div>
    `).join('');
}

function getAssignmentStatusText(status) {
    const statusMap = {
        'active': 'æ´»è·ƒ',
        'completed': 'å·²å®Œæˆ',
        'cancelled': 'å·²å–æ¶ˆ'
    };
    return statusMap[status] || status;
}

function getAssignmentTypeText(type) {
    const typeMap = {
        'personal_training': 'ç§æ•™',
        'group_class': 'å›¢ä½“è¯¾',
        'consultation': 'å’¨è¯¢',
        'fitness_assessment': 'ä½“èƒ½è¯„ä¼°'
    };
    return typeMap[type] || type;
}

async function showMemberTrainerForm() {
    try {
        const trainers = await api.getTrainers();
        
        const content = `
            <form id="memberTrainerForm">
                <div class="form-group">
                    <label for="trainerId">æ•™ç»ƒ *</label>
                    <select id="trainerId" required>
                        <option value="">è¯·é€‰æ‹©æ•™ç»ƒ</option>
                        ${trainers.filter(trainer => trainer.status === 'active').map(trainer => `
                            <option value="${trainer.id}">${trainer.name} - ${trainer.specialization || 'æ— ä¸“ä¸šé¢†åŸŸ'}</option>
                        `).join('')}
                    </select>
                </div>
                <div class="form-group">
                    <label for="assignmentType">æŒ‡æ´¾ç±»å‹ *</label>
                    <select id="assignmentType" required>
                        <option value="">è¯·é€‰æ‹©æŒ‡æ´¾ç±»å‹</option>
                        <option value="personal_training">ç§æ•™</option>
                        <option value="group_class">å›¢ä½“è¯¾</option>
                        <option value="consultation">å’¨è¯¢</option>
                        <option value="fitness_assessment">ä½“èƒ½è¯„ä¼°</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="assignmentDate">æŒ‡æ´¾æ—¥æœŸ *</label>
                    <input type="date" id="assignmentDate" value="${new Date().toISOString().split('T')[0]}" required>
                </div>
                <div class="form-group">
                    <label for="assignmentStatus">çŠ¶æ€</label>
                    <select id="assignmentStatus">
                        <option value="active">æ´»è·ƒ</option>
                        <option value="completed">å·²å®Œæˆ</option>
                        <option value="cancelled">å·²å–æ¶ˆ</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜</button>
                </div>
            </form>
        `;
        
        showModal('æŒ‡æ´¾æ•™ç»ƒ', content);
        document.getElementById('memberTrainerForm').addEventListener('submit', saveMemberTrainerAssignment);
    } catch (error) {
        showMessage('åŠ è½½æ•™ç»ƒåˆ—è¡¨å¤±è´¥', 'error');
        console.error('Failed to load trainers:', error);
    }
}

async function saveMemberTrainerAssignment(event) {
    event.preventDefault();
    
    const assignmentData = {
        trainer_id: parseInt(document.getElementById('trainerId').value),
        assignment_type: document.getElementById('assignmentType').value,
        assignment_date: document.getElementById('assignmentDate').value,
        status: document.getElementById('assignmentStatus').value
    };
    
    try {
        await api.createMemberAssignment(currentMemberId, assignmentData);
        showMessage('æ•™ç»ƒæŒ‡æ´¾æˆåŠŸ', 'success');
        closeModal();
        loadMemberAssignments(currentMemberId);
    } catch (error) {
        showMessage('æ•™ç»ƒæŒ‡æ´¾å¤±è´¥', 'error');
        console.error('Failed to save member trainer assignment:', error);
    }
}

// æ ‡ç­¾é¡µåˆ‡æ¢æ—¶åŠ è½½å¯¹åº”å†…å®¹
function showTab(tabName) {
    const tabs = document.querySelectorAll('.detail-tab');
    const contents = document.querySelectorAll('.detail-content');
    
    tabs.forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-tab') === tabName) {
            tab.classList.add('active');
        }
    });
    
    contents.forEach(content => {
        content.style.display = 'none';
        if (content.id === `${tabName}Content`) {
            content.style.display = 'block';
        }
    });
    
    // æ ¹æ®é€‰ä¸­çš„æ ‡ç­¾é¡µåŠ è½½å¯¹åº”æ•°æ®
    if (currentMemberId) {
        switch(tabName) {
            case 'cards':
                loadMemberCards(currentMemberId);
                break;
            case 'enrollments':
                loadMemberEnrollments(currentMemberId);
                break;
            case 'assignments':
                loadMemberAssignments(currentMemberId);
                break;
        }
    }
}
````

#### 5. æ•™ç»ƒç®¡ç†æ¨¡å—

##### **æ’å…¥**

````SQL
-- æ’å…¥æ•™ç»ƒè¯¾ç¨‹åˆ†é…æ•°æ®
INSERT INTO trainer_course_assignments (trainer_id, course_id, assignment_date, course_type, notes) VALUES
(1, 3, '2023-06-01', 'group', 'è´Ÿè´£åŠ›é‡è®­ç»ƒåŸºç¡€å›¢ä½“è¯¾'),
(1, 8, '2023-12-01', 'group', 'è´Ÿè´£CrossFitå›¢ä½“è®­ç»ƒ'),
(2, 1, '2023-08-15', 'group', 'è´Ÿè´£åˆçº§ç‘œä¼½å›¢ä½“è¯¾'),
(2, 5, '2023-11-01', 'private', 'æä¾›æ™®æ‹‰æç§æ•™æœåŠ¡'),
(3, 2, '2023-09-01', 'group', 'è´Ÿè´£HIITå›¢ä½“è¯¾'),
(3, 7, '2023-10-15', 'group', 'è´Ÿè´£æ‹‰ä¼¸æ”¾æ¾è¯¾ç¨‹'),
(4, 4, '2023-10-15', 'group', 'è´Ÿè´£æå‡»æœ‰æ°§å›¢ä½“è¯¾'),
(4, 8, '2024-01-01', 'special', 'ç‰¹æ®Šæå‡»è®­ç»ƒè¯¾ç¨‹'),
(5, 5, '2023-11-01', 'group', 'è´Ÿè´£æ™®æ‹‰ææ ¸å¿ƒå›¢ä½“è¯¾'),
(5, 9, '2024-01-15', 'group', 'è´Ÿè´£èˆè¹ˆå¥èº«è¯¾ç¨‹'),
(6, 6, '2024-01-15', 'private', 'æä¾›æ¸¸æ³³ç§æ•™æœåŠ¡'),
(6, 10, '2024-02-01', 'group', 'è´Ÿè´£è€å¹´å¥èº«è¯¾ç¨‹'),
(7, 8, '2024-01-10', 'group', 'è´Ÿè´£åŠŸèƒ½æ€§è®­ç»ƒè¯¾ç¨‹'),
(8, 11, '2024-01-05', 'private', 'æä¾›åº·å¤è®­ç»ƒç§æ•™'),
(8, 12, '2024-02-01', 'special', 'äº§åæ¢å¤ä¸“é¡¹è¯¾ç¨‹');
````

![image-20250612130633962](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612130633962.png)

##### **æŸ¥è¯¢**

![image-20250612130714505](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612130714505.png)

##### **åˆ é™¤ï¼ˆé€»è¾‘åˆ é™¤ï¼Œè½¯åˆ é™¤ï¼‰**

**åˆ é™¤å‰**

![image-20250612130731397](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612130731397.png)

**åˆ é™¤å**

![image-20250612130751873](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612130751873.png)

````javascript
async function loadTrainersTab() {
    const mainContent = document.getElementById('main-content');
    mainContent.innerHTML = `
        <div class="trainers-section">
            <div class="section-header">
                <h2>æ•™ç»ƒç®¡ç†</h2>
                <button class="btn btn-primary" onclick="showTrainerForm()">æ·»åŠ æ•™ç»ƒ</button>
            </div>
            <div class="search-bar">
                <input type="text" id="trainerSearch" placeholder="æœç´¢æ•™ç»ƒå§“åæˆ–ä¸“ä¸šé¢†åŸŸ...">
                <button onclick="searchTrainers()">æœç´¢</button>
            </div>
            <div id="trainersContainer" class="content-grid">
                <!-- æ•™ç»ƒåˆ—è¡¨å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </div>
        </div>
    `;
    
    loadTrainers();
}

async function loadTrainers() {
    try {
        const trainers = await api.getTrainers();
        displayTrainers(trainers);
    } catch (error) {
        showMessage('åŠ è½½æ•™ç»ƒåˆ—è¡¨å¤±è´¥', 'error');
        console.error('Failed to load trainers:', error);
    }
}

function displayTrainers(trainers) {
    const container = document.getElementById('trainersContainer');
    
    if (trainers.length === 0) {
        container.innerHTML = '<div class="no-data">æš‚æ— æ•™ç»ƒæ•°æ®</div>';
        return;
    }
    
    container.innerHTML = trainers.map(trainer => `
        <div class="card trainer-card">
            <div class="card-header">
                <h3>${trainer.name}</h3>
                <span class="status status-${trainer.status}">${getStatusText(trainer.status)}</span>
            </div>
            <div class="card-body">
                <p><strong>ç”µè¯:</strong> ${trainer.phone || 'æœªå¡«å†™'}</p>
                <p><strong>é‚®ç®±:</strong> ${trainer.email || 'æœªå¡«å†™'}</p>
                <p><strong>ä¸“ä¸šé¢†åŸŸ:</strong> ${trainer.specialization || 'æœªå¡«å†™'}</p>
                <p><strong>å…¥èŒæ—¥æœŸ:</strong> ${trainer.hire_date || 'æœªçŸ¥'}</p>
            </div>
            <div class="card-actions">
                <button class="btn btn-info" onclick="showTrainerDetail(${trainer.id})">æŸ¥çœ‹è¯¦æƒ…</button>
                <button class="btn btn-warning" onclick="editTrainer(${trainer.id})">ç¼–è¾‘</button>
                <button class="btn btn-danger" onclick="deleteTrainer(${trainer.id})">åˆ é™¤</button>
            </div>
        </div>
    `).join('');
}

function showTrainerDetail(trainerId) {
    loadTrainerDetailTab(trainerId);
}

// filepath: frontend/scripts/trainerDetail.js
let currentTrainerId = null;

async function loadTrainerDetailTab(trainerId) {
    currentTrainerId = trainerId;
    
    try {
        const trainer = await api.getTrainer(trainerId);
        
        const mainContent = document.getElementById('main-content');
        mainContent.innerHTML = `
            <div class="trainer-detail">
                <div class="detail-header">
                    <button class="btn btn-secondary" onclick="loadTrainersTab()">â† è¿”å›æ•™ç»ƒåˆ—è¡¨</button>
                    <h2>${trainer.name} - æ•™ç»ƒè¯¦æƒ…</h2>
                </div>
                
                <div class="trainer-info">
                    <div class="info-grid">
                        <div><strong>å§“å:</strong> ${trainer.name}</div>
                        <div><strong>ç”µè¯:</strong> ${trainer.phone || 'æœªå¡«å†™'}</div>
                        <div><strong>é‚®ç®±:</strong> ${trainer.email || 'æœªå¡«å†™'}</div>
                        <div><strong>ä¸“ä¸šé¢†åŸŸ:</strong> ${trainer.specialization || 'æœªå¡«å†™'}</div>
                        <div><strong>å…¥èŒæ—¥æœŸ:</strong> ${trainer.hire_date || 'æœªçŸ¥'}</div>
                        <div><strong>çŠ¶æ€:</strong> <span class="status status-${trainer.status}">${getStatusText(trainer.status)}</span></div>
                    </div>
                </div>
                
                <div class="trainer-detail-tabs">
                    <button class="trainer-detail-tab active" data-tab="courses" onclick="showTrainerTab('courses')">è¯¾ç¨‹åˆ†é…</button>
                    <button class="trainer-detail-tab" data-tab="members" onclick="showTrainerTab('members')">ä¼šå‘˜æŒ‡æ´¾</button>
                </div>
                
                <div id="trainerCoursesContent" class="trainer-detail-content">
                    <div class="content-header">
                        <h3>è¯¾ç¨‹åˆ†é…</h3>
                        <button class="btn btn-primary" onclick="showTrainerCourseForm()">åˆ†é…è¯¾ç¨‹</button>
                    </div>
                    <div id="trainerCoursesContainer"></div>
                </div>
                
                <div id="trainerMembersContent" class="trainer-detail-content" style="display: none;">
                    <div class="content-header">
                        <h3>ä¼šå‘˜æŒ‡æ´¾</h3>
                    </div>
                    <div id="trainerMembersContainer"></div>
                </div>
            </div>
        `;
        
        // åŠ è½½é»˜è®¤æ ‡ç­¾é¡µå†…å®¹
        loadTrainerCourses(trainerId);
    } catch (error) {
        showMessage('åŠ è½½æ•™ç»ƒè¯¦æƒ…å¤±è´¥', 'error');
        console.error('Failed to load trainer detail:', error);
    }
}

async function loadTrainerCourses(trainerId) {
    try {
        const courses = await api.getTrainerCourses(trainerId);
        displayTrainerCourses(courses);
    } catch (error) {
        showMessage('åŠ è½½æ•™ç»ƒè¯¾ç¨‹å¤±è´¥', 'error');
        console.error('Failed to load trainer courses:', error);
    }
}

function displayTrainerCourses(courses) {
    const container = document.getElementById('trainerCoursesContainer');
    
    if (courses.length === 0) {
        container.innerHTML = '<div class="no-data">æš‚æ— è¯¾ç¨‹åˆ†é…è®°å½•</div>';
        return;
    }
    
    container.innerHTML = courses.map(course => `
        <div class="card">
            <div class="card-header">
                <h4>${course.course_name}</h4>
                <span class="status status-${course.status}">${getStatusText(course.status)}</span>
            </div>
            <div class="card-body">
                <p><strong>è¯¾ç¨‹æè¿°:</strong> ${course.course_description || 'æ— '}</p>
                <p><strong>è¯¾ç¨‹æ—¶é•¿:</strong> ${course.duration}åˆ†é’Ÿ</p>
                <p><strong>è¯¾ç¨‹ä»·æ ¼:</strong> Â¥${course.price}</p>
                <p><strong>åˆ†é…æ—¥æœŸ:</strong> ${course.assignment_date}</p>
            </div>
        </div>
    `).join('');
}

async function loadTrainerMembers(trainerId) {
    try {
        const members = await api.getTrainerMembers(trainerId);
        displayTrainerMembers(members);
    } catch (error) {
        showMessage('åŠ è½½æ•™ç»ƒä¼šå‘˜æŒ‡æ´¾å¤±è´¥', 'error');
        console.error('Failed to load trainer members:', error);
    }
}

function displayTrainerMembers(members) {
    const container = document.getElementById('trainerMembersContainer');
    
    if (members.length === 0) {
        container.innerHTML = '<div class="no-data">æš‚æ— ä¼šå‘˜æŒ‡æ´¾è®°å½•</div>';
        return;
    }
    
    container.innerHTML = members.map(member => `
        <div class="card">
            <div class="card-header">
                <h4>${member.member_name}</h4>
                <span class="status status-${member.status}">${getAssignmentStatusText(member.status)}</span>
            </div>
            <div class="card-body">
                <p><strong>ä¼šå‘˜ç”µè¯:</strong> ${member.member_phone || 'æœªå¡«å†™'}</p>
                <p><strong>ä¼šå‘˜é‚®ç®±:</strong> ${member.member_email || 'æœªå¡«å†™'}</p>
                <p><strong>æŒ‡æ´¾ç±»å‹:</strong> ${getAssignmentTypeText(member.assignment_type)}</p>
                <p><strong>æŒ‡æ´¾æ—¥æœŸ:</strong> ${member.assignment_date}</p>
            </div>
        </div>
    `).join('');
}

function showTrainerTab(tabName) {
    const tabs = document.querySelectorAll('.trainer-detail-tab');
    const contents = document.querySelectorAll('.trainer-detail-content');
    
    tabs.forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-tab') === tabName) {
            tab.classList.add('active');
        }
    });
    
    contents.forEach(content => {
        content.style.display = 'none';
        if (content.id === `trainer${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Content`) {
            content.style.display = 'block';
        }
    });
    
    // æ ¹æ®é€‰ä¸­çš„æ ‡ç­¾é¡µåŠ è½½å¯¹åº”æ•°æ®
    if (currentTrainerId) {
        switch(tabName) {
            case 'courses':
                loadTrainerCourses(currentTrainerId);
                break;
            case 'members':
                loadTrainerMembers(currentTrainerId);
                break;
        }
    }
}
````

#### 6. æ•™ç»ƒè¯¦æƒ…ç®¡ç†æ¨¡å—

##### **æ’å…¥**

````SQL
-- æ’å…¥ä¼šå‘˜æ•™ç»ƒæŒ‡æ´¾æ•°æ®ï¼ˆåŒä¼šå‘˜è¯¦æƒ…æ¨¡å—ä¸­çš„æ’å…¥æ•°æ®ï¼‰
INSERT INTO member_trainer_assignments (member_id, trainer_id, assignment_date, assignment_type, notes) VALUES
(1, 1, '2024-01-18', 'personal_training_package', 'è´­ä¹°10æ¬¡ç§æ•™è¯¾ç¨‹åŒ…'),
(2, 2, '2024-02-03', 'personal_training_package', 'å¹´å¡ç”¨æˆ·ï¼Œæ¯æœˆ2æ¬¡ç§æ•™'),
(3, 1, '2024-02-22', 'consultation', 'åŠ›é‡è®­ç»ƒå’¨è¯¢'),
(4, 6, '2024-02-17', 'personal_training_package', 'VIPä¼šå‘˜æ— é™ç§æ•™'),
(4, 2, '2024-02-19', 'personal_training_package', 'VIPä¼šå‘˜ç‘œä¼½ç§æ•™'),
(5, 3, '2024-02-02', 'personal_training_package', 'è´­ä¹°5æ¬¡æœ‰æ°§ç§æ•™'),
(6, 2, '2024-02-13', 'consultation', 'ç‘œä¼½å…¥é—¨æŒ‡å¯¼'),
(7, 8, '2024-01-28', 'personal_training_package', 'åº·å¤è®­ç»ƒä¸“é¡¹æŒ‡å¯¼'),
(8, 5, '2024-02-24', 'consultation', 'æ™®æ‹‰æåŠ¨ä½œæŒ‡å¯¼'),
(8, 1, '2024-02-25', 'personal_training_package', 'åŠ›é‡è®­ç»ƒç§æ•™');

-- æ’å…¥æ•™ç»ƒè¯¾ç¨‹åˆ†é…æ•°æ®
INSERT INTO trainer_course_assignments (trainer_id, course_id, assignment_date, course_type, notes) VALUES
(1, 3, '2023-06-01', 'group', 'è´Ÿè´£åŠ›é‡è®­ç»ƒåŸºç¡€å›¢ä½“è¯¾'),
(1, 8, '2023-12-01', 'group', 'è´Ÿè´£CrossFitå›¢ä½“è®­ç»ƒ'),
(2, 1, '2023-08-15', 'group', 'è´Ÿè´£åˆçº§ç‘œä¼½å›¢ä½“è¯¾'),
(2, 5, '2023-11-01', 'private', 'æä¾›æ™®æ‹‰æç§æ•™æœåŠ¡'),
(3, 2, '2023-09-01', 'group', 'è´Ÿè´£HIITå›¢ä½“è¯¾'),
(3, 7, '2023-10-15', 'group', 'è´Ÿè´£æ‹‰ä¼¸æ”¾æ¾è¯¾ç¨‹'),
(4, 4, '2023-10-15', 'group', 'è´Ÿè´£æå‡»æœ‰æ°§å›¢ä½“è¯¾'),
(4, 8, '2024-01-01', 'special', 'ç‰¹æ®Šæå‡»è®­ç»ƒè¯¾ç¨‹'),
(5, 5, '2023-11-01', 'group', 'è´Ÿè´£æ™®æ‹‰ææ ¸å¿ƒå›¢ä½“è¯¾'),
(5, 9, '2024-01-15', 'group', 'è´Ÿè´£èˆè¹ˆå¥èº«è¯¾ç¨‹'),
(6, 6, '2024-01-15', 'private', 'æä¾›æ¸¸æ³³ç§æ•™æœåŠ¡'),
(6, 10, '2024-02-01', 'group', 'è´Ÿè´£è€å¹´å¥èº«è¯¾ç¨‹'),
(7, 8, '2024-01-10', 'group', 'è´Ÿè´£åŠŸèƒ½æ€§è®­ç»ƒè¯¾ç¨‹'),
(8, 11, '2024-01-05', 'private', 'æä¾›åº·å¤è®­ç»ƒç§æ•™'),
(8, 12, '2024-02-01', 'special', 'äº§åæ¢å¤ä¸“é¡¹è¯¾ç¨‹');
````

![image-20250612131154275](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612131154275.png)

![image-20250612131224315](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612131224315.png)

##### **åˆ é™¤**

![image-20250612131249512](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612131249512.png)

![image-20250612131313364](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612131313364.png)

![image-20250612131355018](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612131355018.png)

![image-20250612131419554](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612131419554.png)

````javascript
// è¯¾ç¨‹ç±»å‹è½¬æ¢å‡½æ•°
function getCourseTypeText(type) {
    const typeMap = {
        'regular': 'å¸¸è§„è¯¾ç¨‹',
        'special': 'ç‰¹è‰²è¯¾ç¨‹',
        'private': 'ç§æ•™è¯¾ç¨‹',
        'group': 'å›¢ä½“è¯¾ç¨‹'
    };
    return typeMap[type] || type;
}

// æŒ‡æ´¾ç±»å‹è½¬æ¢å‡½æ•°
function getAssignmentTypeText(type) {
    const typeMap = {
        'personal': 'ç§æ•™',
        'group': 'å›¢ä½“è¯¾',
        'consultation': 'å’¨è¯¢',
        'assessment': 'ä½“èƒ½è¯„ä¼°'
    };
    return typeMap[type] || type;
}

// åŠ è½½æ•™ç»ƒè¯¾ç¨‹åˆ†é…åˆ—è¡¨
async function loadTrainerCourses(trainerId) {
    const tbody = document.getElementById('trainerCoursesTableBody');
    tbody.innerHTML = '<tr><td colspan="6" class="loading">æ­£åœ¨åŠ è½½æ•™ç»ƒè¯¾ç¨‹æ•°æ®...</td></tr>';
    
    const response = await api.getTrainerCourses(trainerId);
    
    if (response.success) {
        tbody.innerHTML = '';
        if (response.data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="6">è¯¥æ•™ç»ƒæš‚æ— åˆ†é…è¯¾ç¨‹</td></tr>';
        } else {
            response.data.forEach(assignment => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${assignment.id}</td>
                    <td>${assignment.course_name}</td>
                    <td>${formatDate(assignment.assignment_date)}</td>
                    <td>${getCourseTypeText(assignment.course_type)}</td>
                    <td>${assignment.notes || ''}</td>
                    <td>
                        <button class="btn" onclick="editTrainerCourse(${assignment.id})">ç¼–è¾‘</button>
                        <button class="btn btn-danger" onclick="deleteTrainerCourse(${assignment.id}, '${assignment.course_name}')">å–æ¶ˆ</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
    } else {
        tbody.innerHTML = `<tr><td colspan="6">åŠ è½½å¤±è´¥: ${response.message}</td></tr>`;
    }
}

// åŠ è½½æ•™ç»ƒæŒ‡æ´¾ä¼šå‘˜åˆ—è¡¨
async function loadTrainerMembers(trainerId) {
    const tbody = document.getElementById('trainerMembersTableBody');
    tbody.innerHTML = '<tr><td colspan="6" class="loading">æ­£åœ¨åŠ è½½æ•™ç»ƒä¼šå‘˜æ•°æ®...</td></tr>';
    
    const response = await api.getTrainerMembers(trainerId);
    
    if (response.success) {
        tbody.innerHTML = '';
        if (response.data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="6">è¯¥æ•™ç»ƒæš‚æ— æŒ‡æ´¾ä¼šå‘˜</td></tr>';
        } else {
            response.data.forEach(assignment => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${assignment.id}</td>
                    <td>${assignment.member_name}</td>
                    <td>${formatDate(assignment.assignment_date)}</td>
                    <td>${getAssignmentTypeText(assignment.assignment_type)}</td>
                    <td>${assignment.notes || ''}</td>
                    <td>
                        <button class="btn" onclick="editTrainerMember(${assignment.id})">ç¼–è¾‘</button>
                        <button class="btn btn-danger" onclick="deleteTrainerMember(${assignment.id}, '${assignment.member_name}')">è§£é™¤</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
    } else {
        tbody.innerHTML = `<tr><td colspan="6">åŠ è½½å¤±è´¥: ${response.message}</td></tr>`;
    }
}

// æ˜¾ç¤ºæ•™ç»ƒè¯¾ç¨‹åˆ†é…è¡¨å•
async function showTrainerCourseForm(assignmentId = null) {
    const courses = await api.getCourses(true);
    if (!courses.success) {
        showMessage('æ— æ³•åŠ è½½è¯¾ç¨‹åˆ—è¡¨', 'error');
        return;
    }
    
    let assignment = null;
    if (assignmentId) {
        const assignmentsResponse = await api.getTrainerCourses(currentTrainerId);
        if (assignmentsResponse.success) {
            assignment = assignmentsResponse.data.find(a => a.id === assignmentId);
        }
    }
    
    const title = assignment ? 'ç¼–è¾‘è¯¾ç¨‹åˆ†é…' : 'åˆ†é…æ–°è¯¾ç¨‹';
    const courseOptions = courses.data.map(course => 
        `<option value="${course.id}" ${assignment && assignment.course_id === course.id ? 'selected' : ''}>${course.name}</option>`
    ).join('');
    
    const formContent = `
        <div class="form">
            <h3>${title}</h3>
            <div class="form-group">
                <label for="trainerCourse">è¯¾ç¨‹ *</label>
                <select id="trainerCourse" required>
                    <option value="">è¯·é€‰æ‹©è¯¾ç¨‹</option>
                    ${courseOptions}
                </select>
            </div>
            <div class="form-group">
                <label for="trainerCourseDate">åˆ†é…æ—¥æœŸ *</label>
                <input type="date" id="trainerCourseDate" value="${assignment ? assignment.assignment_date.split(' ')[0] : getTodayDate()}" required>
            </div>
            <div class="form-group">
                <label for="trainerCourseType">è¯¾ç¨‹ç±»å‹</label>
                <select id="trainerCourseType">
                    <option value="">è¯·é€‰æ‹©ç±»å‹</option>
                    <option value="regular" ${assignment && assignment.course_type === 'regular' ? 'selected' : ''}>å¸¸è§„è¯¾ç¨‹</option>
                    <option value="special" ${assignment && assignment.course_type === 'special' ? 'selected' : ''}>ç‰¹è‰²è¯¾ç¨‹</option>
                    <option value="private" ${assignment && assignment.course_type === 'private' ? 'selected' : ''}>ç§æ•™è¯¾ç¨‹</option>
                    <option value="group" ${assignment && assignment.course_type === 'group' ? 'selected' : ''}>å›¢ä½“è¯¾ç¨‹</option>
                </select>
            </div>
            <div class="form-group">
                <label for="trainerCourseNotes">å¤‡æ³¨</label>
                <textarea id="trainerCourseNotes">${assignment ? assignment.notes || '' : ''}</textarea>
            </div>
            <div class="form-actions">
                <button type="button" class="btn" onclick="closeModal()">å–æ¶ˆ</button>
                <button type="button" class="btn btn-primary" onclick="saveTrainerCourse(${assignmentId || 'null'})">${assignment ? 'æ›´æ–°' : 'åˆ†é…'}</button>
            </div>
        </div>
    `;
    
    showModal(formContent);
}

// ä¿å­˜æ•™ç»ƒè¯¾ç¨‹åˆ†é…
async function saveTrainerCourse(assignmentId) {
    const assignmentData = {
        course_id: parseInt(document.getElementById('trainerCourse').value),
        assignment_date: document.getElementById('trainerCourseDate').value,
        course_type: document.getElementById('trainerCourseType').value,
        notes: document.getElementById('trainerCourseNotes').value.trim()
    };
    
    if (!assignmentData.course_id) {
        showMessage('è¯·é€‰æ‹©è¯¾ç¨‹', 'error');
        return;
    }
    
    if (!assignmentData.assignment_date) {
        showMessage('åˆ†é…æ—¥æœŸä¸èƒ½ä¸ºç©º', 'error');
        return;
    }
    
    let response;
    if (assignmentId) {
        response = await api.updateTrainerCourse(assignmentId, assignmentData);
    } else {
        response = await api.assignCourseToTrainer(currentTrainerId, assignmentData);
    }
    
    if (response.success) {
        showMessage(response.message, 'success');
        closeModal();
        loadTrainerCourses(currentTrainerId);
    } else {
        showMessage(response.message, 'error');
    }
}

// æ˜¾ç¤ºæ•™ç»ƒä¼šå‘˜æŒ‡æ´¾è¡¨å•
async function showTrainerMemberForm(assignmentId = null) {
    const members = await api.getMembers();
    if (!members.success) {
        showMessage('æ— æ³•åŠ è½½ä¼šå‘˜åˆ—è¡¨', 'error');
        return;
    }
    
    let assignment = null;
    if (assignmentId) {
        const assignmentsResponse = await api.getTrainerMembers(currentTrainerId);
        if (assignmentsResponse.success) {
            assignment = assignmentsResponse.data.find(a => a.id === assignmentId);
        }
    }
    
    const title = assignment ? 'ç¼–è¾‘ä¼šå‘˜æŒ‡æ´¾' : 'æŒ‡æ´¾æ–°ä¼šå‘˜';
    const memberOptions = members.data.filter(member => member.status === 'active').map(member => 
        `<option value="${member.id}" ${assignment && assignment.member_id === member.id ? 'selected' : ''}>${member.name}</option>`
    ).join('');
    
    const formContent = `
        <div class="form">
            <h3>${title}</h3>
            <div class="form-group">
                <label for="trainerMember">ä¼šå‘˜ *</label>
                <select id="trainerMember" required>
                    <option value="">è¯·é€‰æ‹©ä¼šå‘˜</option>
                    ${memberOptions}
                </select>
            </div>
            <div class="form-group">
                <label for="trainerMemberDate">æŒ‡æ´¾æ—¥æœŸ *</label>
                <input type="date" id="trainerMemberDate" value="${assignment ? assignment.assignment_date.split(' ')[0] : getTodayDate()}" required>
            </div>
            <div class="form-group">
                <label for="trainerMemberType">æŒ‡æ´¾ç±»å‹</label>
                <select id="trainerMemberType">
                    <option value="">è¯·é€‰æ‹©ç±»å‹</option>
                    <option value="personal" ${assignment && assignment.assignment_type === 'personal' ? 'selected' : ''}>ç§æ•™</option>
                    <option value="group" ${assignment && assignment.assignment_type === 'group' ? 'selected' : ''}>å›¢ä½“è¯¾</option>
                    <option value="consultation" ${assignment && assignment.assignment_type === 'consultation' ? 'selected' : ''}>å’¨è¯¢</option>
                    <option value="assessment" ${assignment && assignment.assignment_type === 'assessment' ? 'selected' : ''}>ä½“èƒ½è¯„ä¼°</option>
                </select>
            </div>
            <div class="form-group">
                <label for="trainerMemberNotes">å¤‡æ³¨</label>
                <textarea id="trainerMemberNotes">${assignment ? assignment.notes || '' : ''}</textarea>
            </div>
            <div class="form-actions">
                <button type="button" class="btn" onclick="closeModal()">å–æ¶ˆ</button>
                <button type="button" class="btn btn-primary" onclick="saveTrainerMember(${assignmentId || 'null'})">${assignment ? 'æ›´æ–°' : 'æŒ‡æ´¾'}</button>
            </div>
        </div>
    `;
    
    showModal(formContent);
}

// ä¿å­˜æ•™ç»ƒä¼šå‘˜æŒ‡æ´¾
async function saveTrainerMember(assignmentId) {
    const assignmentData = {
        member_id: parseInt(document.getElementById('trainerMember').value),
        assignment_date: document.getElementById('trainerMemberDate').value,
        assignment_type: document.getElementById('trainerMemberType').value,
        notes: document.getElementById('trainerMemberNotes').value.trim()
    };
    
    if (!assignmentData.member_id) {
        showMessage('è¯·é€‰æ‹©ä¼šå‘˜', 'error');
        return;
    }
    
    if (!assignmentData.assignment_date) {
        showMessage('æŒ‡æ´¾æ—¥æœŸä¸èƒ½ä¸ºç©º', 'error');
        return;
    }
    
    let response;
    if (assignmentId) {
        response = await api.updateMemberAssignment(assignmentId, assignmentData);
    } else {
        response = await api.assignTrainerToMember(assignmentData.member_id, {
            trainer_id: currentTrainerId,
            assignment_date: assignmentData.assignment_date,
            assignment_type: assignmentData.assignment_type,
            notes: assignmentData.notes
        });
    }
    
    if (response.success) {
        showMessage(response.message, 'success');
        closeModal();
        loadTrainerMembers(currentTrainerId);
    } else {
        showMessage(response.message, 'error');
    }
}

function editTrainerCourse(assignmentId) {
    showTrainerCourseForm(assignmentId);
}

function deleteTrainerCourse(assignmentId, courseName) {
    confirmAction(`ç¡®å®šè¦å–æ¶ˆæ•™ç»ƒå¯¹ "${courseName}" è¯¾ç¨‹çš„åˆ†é…å—ï¼Ÿ`, async () => {
        const response = await api.deleteTrainerCourse(assignmentId);
        if (response.success) {
            showMessage(response.message, 'success');
            loadTrainerCourses(currentTrainerId);
        } else {
            showMessage(response.message, 'error');
        }
    });
}

function editTrainerMember(assignmentId) {
    showTrainerMemberForm(assignmentId);
}

function deleteTrainerMember(assignmentId, memberName) {
    confirmAction(`ç¡®å®šè¦è§£é™¤æ•™ç»ƒä¸ä¼šå‘˜ "${memberName}" çš„æŒ‡æ´¾å…³ç³»å—ï¼Ÿ`, async () => {
        const response = await api.deleteMemberAssignment(assignmentId);
        if (response.success) {
            showMessage(response.message, 'success');
            loadTrainerMembers(currentTrainerId);
        } else {
            showMessage(response.message, 'error');
        }
    });
}
````

#### 7. è¯¾ç¨‹ç®¡ç†æ¨¡å—

##### **æ’å…¥**

````sQL
-- æ’å…¥è¯¾ç¨‹æ•°æ®
INSERT INTO courses (name, description, default_duration_minutes, status) VALUES
('åˆçº§ç‘œä¼½', 'é€‚åˆåˆå­¦è€…çš„åŸºç¡€ç‘œä¼½è¯¾ç¨‹ï¼Œæ³¨é‡æŸ”éŸ§æ€§å’Œå‘¼å¸ç»ƒä¹ ', 60, 'active'),
('é«˜å¼ºåº¦é—´æ­‡è®­ç»ƒ', 'HIITè®­ç»ƒï¼Œå¿«é€Ÿç‡ƒè„‚ï¼Œæé«˜å¿ƒè‚ºåŠŸèƒ½', 45, 'active'),
('åŠ›é‡è®­ç»ƒåŸºç¡€', 'å™¨æ¢°ä½¿ç”¨æŒ‡å¯¼å’ŒåŸºç¡€åŠ›é‡è®­ç»ƒ', 90, 'active'),
('æå‡»æœ‰æ°§', 'ç»“åˆæ‹³å‡»åŠ¨ä½œçš„æœ‰æ°§è¿åŠ¨ï¼Œé‡Šæ”¾å‹åŠ›', 60, 'active'),
('æ™®æ‹‰ææ ¸å¿ƒ', 'ä¸“æ³¨æ ¸å¿ƒè‚Œç¾¤è®­ç»ƒçš„æ™®æ‹‰æè¯¾ç¨‹', 50, 'active'),
('æ¸¸æ³³æŠ€å·§æå‡', 'æ”¹è¿›æ¸¸æ³³æŠ€å·§ï¼Œæé«˜æ¸¸æ³³æ•ˆç‡', 60, 'active'),
('æ‹‰ä¼¸æ”¾æ¾', 'å…¨èº«æ‹‰ä¼¸å’Œæ”¾æ¾è®­ç»ƒ', 30, 'active'),
('CrossFitè®­ç»ƒ', 'ç»¼åˆåŠŸèƒ½æ€§è®­ç»ƒï¼ŒæŒ‘æˆ˜æé™', 75, 'active'),
('èˆè¹ˆå¥èº«', 'ç»“åˆèˆè¹ˆåŠ¨ä½œçš„è¶£å‘³å¥èº«è¯¾ç¨‹', 55, 'active'),
('è€å¹´å¥èº«', 'é€‚åˆä¸­è€å¹´äººçš„æ¸©å’Œå¥èº«è¯¾ç¨‹', 40, 'active'),
('åº·å¤è®­ç»ƒ', 'é’ˆå¯¹ä¼¤ç—…æ¢å¤çš„ä¸“ä¸šåº·å¤è®­ç»ƒ', 45, 'active'),
('äº§åæ¢å¤', 'ä¸“ä¸ºäº§åå¥³æ€§è®¾è®¡çš„æ¢å¤è®­ç»ƒ', 50, 'active');
````

![image-20250611200136095](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250611200136095.png)

##### **æŸ¥è¯¢**

![image-20250611200249204](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250611200249204.png)

##### åˆ é™¤ï¼ˆé€»è¾‘åˆ é™¤ï¼Œè½¯åˆ é™¤ï¼‰

**åˆ é™¤å‰**

![image-20250612130530613](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612130530613.png)

**åˆ é™¤å**

![image-20250612130612033](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612130612033.png)

````javascript
async function loadCoursesTab() {
    const mainContent = document.getElementById('main-content');
    mainContent.innerHTML = `
        <div class="courses-section">
            <div class="section-header">
                <h2>è¯¾ç¨‹ç®¡ç†</h2>
                <button class="btn btn-primary" onclick="showCourseForm()">æ·»åŠ è¯¾ç¨‹</button>
            </div>
            <div class="search-bar">
                <input type="text" id="courseSearch" placeholder="æœç´¢è¯¾ç¨‹åç§°æˆ–æè¿°...">
                <button onclick="searchCourses()">æœç´¢</button>
            </div>
            <div id="coursesContainer" class="content-grid">
                <!-- è¯¾ç¨‹åˆ—è¡¨å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </div>
        </div>
    `;
    
    loadCourses();
}

async function loadCourses() {
    try {
        const courses = await api.getCourses();
        displayCourses(courses);
    } catch (error) {
        showMessage('åŠ è½½è¯¾ç¨‹åˆ—è¡¨å¤±è´¥', 'error');
        console.error('Failed to load courses:', error);
    }
}

async function searchCourses() {
    const searchTerm = document.getElementById('courseSearch').value;
    try {
        const courses = await api.getCourses(searchTerm);
        displayCourses(courses);
    } catch (error) {
        showMessage('æœç´¢è¯¾ç¨‹å¤±è´¥', 'error');
        console.error('Failed to search courses:', error);
    }
}

function displayCourses(courses) {
    const container = document.getElementById('coursesContainer');
    
    if (courses.length === 0) {
        container.innerHTML = '<div class="no-data">æš‚æ— è¯¾ç¨‹æ•°æ®</div>';
        return;
    }
    
    container.innerHTML = courses.map(course => `
        <div class="card course-card">
            <div class="card-header">
                <h3>${course.name}</h3>
                <span class="status status-${course.status}">${getStatusText(course.status)}</span>
            </div>
            <div class="card-body">
                <p><strong>æè¿°:</strong> ${course.description || 'æ— æè¿°'}</p>
                <p><strong>æ—¶é•¿:</strong> ${course.duration}åˆ†é’Ÿ</p>
                <p><strong>ä»·æ ¼:</strong> Â¥${course.price}</p>
            </div>
            <div class="card-actions">
                <button class="btn btn-warning" onclick="editCourse(${course.id})">ç¼–è¾‘</button>
                <button class="btn btn-danger" onclick="deleteCourse(${course.id})">åˆ é™¤</button>
            </div>
        </div>
    `).join('');
}

function showCourseForm(courseId = null) {
    const isEdit = courseId !== null;
    const title = isEdit ? 'ç¼–è¾‘è¯¾ç¨‹' : 'æ·»åŠ è¯¾ç¨‹';
    
    const content = `
        <form id="courseForm">
            <input type="hidden" id="courseId" value="${courseId || ''}">
            <div class="form-group">
                <label for="courseName">è¯¾ç¨‹åç§° *</label>
                <input type="text" id="courseName" required>
            </div>
            <div class="form-group">
                <label for="courseDescription">è¯¾ç¨‹æè¿°</label>
                <textarea id="courseDescription" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="courseDuration">è¯¾ç¨‹æ—¶é•¿(åˆ†é’Ÿ) *</label>
                <input type="number" id="courseDuration" min="1" required>
            </div>
            <div class="form-group">
                <label for="coursePrice">è¯¾ç¨‹ä»·æ ¼ *</label>
                <input type="number" id="coursePrice" min="0" step="0.01" required>
            </div>
            <div class="form-group">
                <label for="courseStatus">çŠ¶æ€</label>
                <select id="courseStatus">
                    <option value="active">æ´»è·ƒ</option>
                    <option value="inactive">éæ´»è·ƒ</option>
                </select>
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                <button type="submit" class="btn btn-primary">ä¿å­˜</button>
            </div>
        </form>
    `;
    
    showModal(title, content);
    document.getElementById('courseForm').addEventListener('submit', saveCourse);
}

async function saveCourse(event) {
    event.preventDefault();
    
    const courseData = {
        name: document.getElementById('courseName').value,
        description: document.getElementById('courseDescription').value,
        duration: parseInt(document.getElementById('courseDuration').value),
        price: parseFloat(document.getElementById('coursePrice').value),
        status: document.getElementById('courseStatus').value
    };
    
    try {
        await api.createCourse(courseData);
        showMessage('è¯¾ç¨‹ä¿å­˜æˆåŠŸ', 'success');
        closeModal();
        loadCourses();
    } catch (error) {
        showMessage('ä¿å­˜è¯¾ç¨‹å¤±è´¥', 'error');
        console.error('Failed to save course:', error);
    }
}
````

#### 8. ä¼šå‘˜å¡ç®¡ç†æ¨¡å—

##### **æ’å…¥**

````sQL
-- æ’å…¥ä¼šå‘˜å¡ç±»å‹æ•°æ®
INSERT INTO membership_card_types (name, price, duration_days, description) VALUES
('æœˆå¡', 299.00, 30, '30å¤©æœ‰æ•ˆæœŸï¼Œå¯ä½¿ç”¨æ‰€æœ‰åŸºç¡€è®¾æ–½å’Œå›¢ä½“è¯¾ç¨‹'),
('å­£å¡', 799.00, 90, '90å¤©æœ‰æ•ˆæœŸï¼ŒåŒ…å«åŸºç¡€è®¾æ–½ã€å›¢ä½“è¯¾ç¨‹å’Œ2æ¬¡ç§æ•™ä½“éªŒ'),
('åŠå¹´å¡', 1399.00, 180, '180å¤©æœ‰æ•ˆæœŸï¼ŒåŒ…å«æ‰€æœ‰è®¾æ–½ã€æ— é™å›¢ä½“è¯¾ç¨‹å’Œ4æ¬¡ç§æ•™'),
('å¹´å¡', 2399.00, 365, '365å¤©æœ‰æ•ˆæœŸï¼ŒåŒ…å«æ‰€æœ‰æœåŠ¡ã€æ— é™è¯¾ç¨‹å’Œæ¯æœˆ2æ¬¡ç§æ•™'),
('VIPå¹´å¡', 3999.00, 365, '365å¤©æœ‰æ•ˆæœŸï¼ŒVIPä¸“äº«åŒºåŸŸã€æ— é™ç§æ•™å’Œè¥å…»æŒ‡å¯¼');
````

![image-20250612133110324](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612133110324.png)

##### **æŸ¥è¯¢**

![image-20250612133132005](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612133132005.png)

##### åˆ é™¤

**åˆ é™¤å‰**

![image-20250612133153582](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612133153582.png)

**åˆ é™¤å**

![image-20250612133217631](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20250612133217631.png)

#### 9. æ ·å¼è®¾è®¡

````css
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f5f5f5;
    color: #333;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

header h1 {
    margin-bottom: 20px;
    text-align: center;
    font-size: 2.5em;
}

.nav-tabs {
    display: flex;
    justify-content: center;
    gap: 10px;
    flex-wrap: wrap;
}

.nav-tab {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 16px;
}

.nav-tab:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: translateY(-2px);
}

.nav-tab.active {
    background: rgba(255, 255, 255, 0.9);
    color: #667eea;
    font-weight: bold;
}

.dashboard {
    text-align: center;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 30px;
}

.stat-card {
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-5px);
}

.stat-card h3 {
    color: #666;
    margin-bottom: 15px;
    font-size: 1.2em;
}

.stat-number {
    font-size: 3em;
    font-weight: bold;
    color: #667eea;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    flex-wrap: wrap;
    gap: 10px;
}

.section-header h2 {
    color: #333;
    font-size: 2em;
}

.search-bar {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    align-items: center;
}

.search-bar input {
    flex: 1;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 16px;
}

.content-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 20px;
}

.card {
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    transition: all 0.3s ease;
}

.card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
}

.card-header {
    padding: 20px;
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.card-header h3, .card-header h4 {
    margin: 0;
    font-size: 1.3em;
}

.card-body {
    padding: 20px;
}

.card-body p {
    margin-bottom: 10px;
    line-height: 1.5;
}

.card-actions {
    padding: 15px 20px;
    background: #f8f9fa;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.btn {
    padding: 8px 16px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-block;
    text-align: center;
}

.btn-primary {
    background: #667eea;
    color: white;
}

.btn-primary:hover {
    background: #5a6fd8;
    transform: translateY(-1px);
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background: #545b62;
}

.btn-info {
    background: #17a2b8;
    color: white;
}

.btn-info:hover {
    background: #138496;
}

.btn-warning {
    background: #ffc107;
    color: #212529;
}

.btn-warning:hover {
    background: #e0a800;
}

.btn-danger {
    background: #dc3545;
    color: white;
}

.btn-danger:hover {
    background: #c82333;
}

.status {
    padding: 4px 12px;
    border-radius: 15px;
    font-size: 12px;
    font-weight: bold;
    text-transform: uppercase;
}

.status-active {
    background: #d4edda;
    color: #155724;
}

.status-inactive {
    background: #f8d7da;
    color: #721c24;
}

.status-suspended {
    background: #fff3cd;
    color: #856404;
}

/* æ¨¡æ€æ¡†æ ·å¼ */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
}

.modal-content {
    background-color: white;
    margin: 5% auto;
    padding: 0;
    border-radius: 10px;
    width: 90%;
    max-width: 500px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}

.modal-header {
    padding: 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 10px 10px 0 0;
}

.modal-body {
    padding: 20px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
    color: #333;
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 16px;
    transition: border-color 0.3s ease;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.form-actions {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
    margin-top: 20px;
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
    padding: 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
}

.detail-tabs,
.trainer-detail-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    flex-wrap: wrap;
}

.detail-tab,
.trainer-detail-tab {
    padding: 10px 20px;
    background: white;
    border: 2px solid #ddd;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
}

.detail-tab.active,
.trainer-detail-tab.active {
    background: #667eea;
    color: white;
    border-color: #667eea;
}

.detail-content,
.trainer-detail-content {
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.content-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.no-data {
    text-align: center;
    color: #666;
    font-style: italic;
    padding: 40px;
    background: #f8f9fa;
    border-radius: 10px;
}

/* æ¶ˆæ¯æç¤ºæ ·å¼ */
.message {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 15px 20px;
    border-radius: 6px;
    color: white;
    font-weight: 500;
    z-index: 1001;
    animation: slideIn 0.3s ease;
}

.message-success {
    background: #28a745;
}

.message-error {
    background: #dc3545;
}

@keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .container {
        padding: 10px;
    }
    
    .nav-tabs {
        flex-direction: column;
        align-items: center;
    }
    
    .nav-tab {
        width: 200px;
        text-align: center;
    }
    
    .section-header {
        flex-direction: column;
        align-items: stretch;
    }
    
    .content-grid {
        grid-template-columns: 1fr;
    }
    
    .search-bar {
        flex-direction: column;
    }
    
    .card-actions {
        flex-direction: column;
    }
    
    .info-grid {
        grid-template-columns: 1fr;
    }
    
    .detail-tabs,
    .trainer-detail-tabs {
        flex-direction: column;
    }
    
    .modal-content {
        width: 95%;
        margin: 10% auto;
    }
}
````

## å…­ã€å®éªŒæ€»ç»“

é€šè¿‡æœ¬æ¬¡å¥èº«æˆ¿ç®¡ç†ç³»ç»Ÿçš„å¼€å‘ï¼Œæˆ‘è·å¾—äº†å…¨é¢è€Œæ·±å…¥çš„å­¦ä¹ ä½“éªŒï¼š

### æŠ€æœ¯èƒ½åŠ›æå‡

ğŸ”§ **æ•°æ®åº“è®¾è®¡èƒ½åŠ›**ï¼šä»éœ€æ±‚åˆ†æåˆ°E-Rå»ºæ¨¡ï¼Œå†åˆ°ç‰©ç†è®¾è®¡ï¼Œå®Œæ•´æŒæ¡äº†æ•°æ®åº“è®¾è®¡çš„å…¨æµç¨‹ã€‚ç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤æ‚çš„å¤šå¯¹å¤šå…³ç³»ï¼ˆå¦‚ä¼šå‘˜-è¯¾ç¨‹ã€æ•™ç»ƒ-ä¼šå‘˜ï¼‰æ—¶ï¼Œæ·±åˆ»ç†è§£äº†å…³ç³»å‹æ•°æ®åº“çš„è®¾è®¡åŸåˆ™ã€‚

ğŸ“Š **SQLæŠ€èƒ½ç²¾è¿›**ï¼šç†Ÿç»ƒè¿ç”¨äº†å¤æ‚çš„å¤šè¡¨è¿æ¥æŸ¥è¯¢ã€èšåˆå‡½æ•°ã€å­æŸ¥è¯¢ç­‰é«˜çº§SQLæŠ€æœ¯ã€‚åœ¨å®ç°ä¼šå‘˜è¯¦æƒ…æŸ¥è¯¢ã€ç»Ÿè®¡åˆ†æç­‰åŠŸèƒ½æ—¶ï¼Œä½“éªŒäº†SQLçš„å¼ºå¤§å¨åŠ›ã€‚

ğŸŒ **å…¨æ ˆå¼€å‘ç»éªŒ**ï¼šç¬¬ä¸€æ¬¡å®Œæ•´å®ç°äº†å‰åç«¯åˆ†ç¦»çš„æ¶æ„è®¾è®¡ï¼Œä½¿ç”¨Flaskæ„å»ºRESTful APIï¼ŒJavaScriptå®ç°åŠ¨æ€å‰ç«¯äº¤äº’ï¼Œè·å¾—äº†ç°ä»£Webå¼€å‘çš„å®Œæ•´ä½“éªŒã€‚

### ç³»ç»Ÿè®¾è®¡æ€ç»´

ğŸ—ï¸ **æ¨¡å—åŒ–æ¶æ„è®¾è®¡**ï¼šé¡¹ç›®é‡‡ç”¨äº†æ¸…æ™°çš„æ¨¡å—åŒ–è®¾è®¡ï¼Œå‰ç«¯æŒ‰åŠŸèƒ½æ¨¡å—åˆ†ç¦»ï¼Œåç«¯APIèŒè´£å•ä¸€ï¼Œè¿™ç§è®¾è®¡å¤§å¤§æé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚

ğŸ’¡ **ä¸šåŠ¡é€»è¾‘ç†è§£**ï¼šé€šè¿‡å¥èº«æˆ¿ç®¡ç†ç³»ç»Ÿçš„å¼€å‘ï¼Œæ·±å…¥ç†è§£äº†ç°å®ä¸šåŠ¡çš„å¤æ‚æ€§ï¼ŒåŒ…æ‹¬ä¼šå‘˜ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€è¯¾ç¨‹è¿è¥ã€æ•™ç»ƒèµ„æºåˆ†é…ç­‰å¤šç»´åº¦çš„ä¸šåŠ¡å…³ç³»ã€‚

ğŸ”„ **æ•°æ®æµè®¾è®¡**ï¼šè®¾è®¡äº†å®Œæ•´çš„æ•°æ®æµè½¬æœºåˆ¶ï¼Œä»ç”¨æˆ·æ“ä½œåˆ°æ•°æ®åº“æ›´æ–°ï¼Œå†åˆ°ç•Œé¢åé¦ˆï¼Œå½¢æˆäº†é—­ç¯çš„æ•°æ®å¤„ç†æµç¨‹ã€‚

### é¡¹ç›®äº®ç‚¹æ€»ç»“

âœ¨ **åŠŸèƒ½å®Œæ•´æ€§**ï¼šç³»ç»Ÿæ¶µç›–äº†å¥èº«æˆ¿è¿è¥çš„æ ¸å¿ƒä¸šåŠ¡æµç¨‹ï¼ŒåŒ…æ‹¬8ä¸ªä¸»è¦æ•°æ®è¡¨ï¼Œ30å¤šä¸ªAPIæ¥å£ï¼Œå®ç°äº†å®Œæ•´çš„CRUDæ“ä½œã€‚

ğŸ¯ **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**ï¼šé‡‡ç”¨å•é¡µé¢åº”ç”¨è®¾è®¡ï¼Œæ¨¡æ€æ¡†äº¤äº’ï¼Œå®æ—¶æ¶ˆæ¯æç¤ºï¼Œæä¾›äº†æµç•…çš„ç”¨æˆ·ä½“éªŒã€‚

ğŸ“± **å“åº”å¼è®¾è®¡**ï¼šæ”¯æŒå¤šç§è®¾å¤‡è®¿é—®ï¼Œå…·æœ‰è‰¯å¥½çš„ç§»åŠ¨ç«¯é€‚é…æ€§ã€‚

ğŸ” **æ•°æ®ç»Ÿè®¡åˆ†æ**ï¼šå®ç°äº†å¤šç»´åº¦çš„æ•°æ®ç»Ÿè®¡åŠŸèƒ½ï¼Œä¸ºå¥èº«æˆ¿è¿è¥æä¾›æ•°æ®æ”¯æŒã€‚

### å­¦ä¹ æ”¶è·

ğŸ“š **ç†è®ºä¸å®è·µç»“åˆ**ï¼šå°†æ•°æ®åº“ç†è®ºçŸ¥è¯†æˆåŠŸåº”ç”¨åˆ°å®é™…é¡¹ç›®ä¸­ï¼ŒåŠ æ·±äº†å¯¹æ•°æ®åº“è®¾è®¡åŸç†çš„ç†è§£ã€‚

ğŸ› ï¸ **é—®é¢˜è§£å†³èƒ½åŠ›**ï¼šåœ¨å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°äº†å¤–é”®çº¦æŸã€å¹¶å‘è®¿é—®ã€æ•°æ®ä¸€è‡´æ€§ç­‰é—®é¢˜ï¼Œé€šè¿‡æŸ¥é˜…èµ„æ–™å’Œå®è·µè§£å†³ï¼Œæå‡äº†ç‹¬ç«‹è§£å†³é—®é¢˜çš„èƒ½åŠ›ã€‚

ğŸ‘¥ **å›¢é˜Ÿåä½œæ„è¯†**ï¼šè™½ç„¶æ˜¯ä¸ªäººé¡¹ç›®ï¼Œä½†åœ¨è®¾è®¡APIæ¥å£ã€ç¼–å†™æ–‡æ¡£æ—¶ï¼ŒåŸ¹å…»äº†å›¢é˜Ÿåä½œçš„æ„è¯†å’Œè§„èŒƒåŒ–å¼€å‘çš„ä¹ æƒ¯ã€‚
